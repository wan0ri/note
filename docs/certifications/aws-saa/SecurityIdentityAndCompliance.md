---
title: セキュリティ・アイデンティティ・コンプライアンス
---

## AWS IAM Identity Center (旧 AWS Single Sign-On)

### 1. サービス概要

AWS IAM Identity Center (旧 AWS Single Sign-On) は、AWS 環境全体へのアクセスを単一の場所で一元的に管理するためのサービスである。  
組織内のユーザーやグループに対し、複数の AWS アカウントやアプリケーションへのシングルサインオン（SSO）を提供する。  
これにより、ユーザーは AWS リソースへのアクセスを効率的に管理でき、セキュリティを向上させることができる。

主なユースケースとして、

- 複数の AWS アカウントの統合管理
- 企業の ID プロバイダー（IdP）との連携
- AWS リソースへのアクセス権限の一元管理
- 多要素認証（MFA）の適用

などが挙げられます。

## 2. 主な特徴と機能

#### 2.1 シングルサインオン (SSO)

IAM Identity Center は、ユーザーが一度認証を受けると、複数の AWS アカウントやアプリケーションに再度認証することなくアクセスできるシングルサインオン機能を提供する。  
これにより、ユーザーの利便性を向上させ、パスワード管理の手間を軽減できる。

#### 2.2 組織との統合

AWS Organizations と連携し、組織内のすべての AWS アカウントに対して、IAM Identity Center で一元的にアクセスを制御できる。  
これにより、アカウントが増えても管理が複雑になることを防ぐ。

#### 2.3 ID プロバイダー (IdP) との連携

Microsoft Active Directory、Okta、Azure AD などの外部 ID プロバイダーと連携して、既存のユーザーアカウントをそのまま使用できる。  
これにより、既存の ID 管理システムとの統合が容易になり、ユーザー管理の手間を削減できる。

- **SAML 2.0**: 主要な IdP と連携するための標準プロトコル
- **SCIM**: ユーザープロビジョニングを自動化するための標準プロトコル

#### 2.4 アクセス制御と権限管理

IAM Identity Center では、ユーザーやグループに対して、AWS アカウントやアプリケーションへのアクセス許可を付与できる。  
AWS マネージドポリシーやカスタムポリシーを使用し、きめ細かいアクセス制御を実現できる。

- **Permission Sets**: AWS アカウントへのアクセス権限を定義
- **AWS Managed Policies**: AWS が提供する定義済みの権限ポリシー

#### 2.5 多要素認証 (MFA)

セキュリティを強化するために、多要素認証（MFA）を適用できる。  
これにより、パスワード漏洩のリスクを低減し、不正アクセスを防ぐことができる。

- **MFA オプション**: 仮想 MFA デバイス、物理 MFA デバイス、SMS 認証

#### 2.6 セルフサービスポータル

IAM Identity Center には、ユーザーが自分自身でアクセス可能な AWS アカウントやアプリケーションを確認できるセルフサービスポータルがある。

### 3. アーキテクチャおよび技術要素

1. ユーザーは IAM Identity Center にログインする（直接または IdP 経由）。
2. IAM Identity Center は、ユーザーの認証情報を検証する。
3. 認証に成功すると、ユーザーは割り当てられた AWS アカウントやアプリケーションへのアクセス許可を取得する。
4. ユーザーは、シングルサインオンで AWS リソースにアクセスできる。
5. IAM Identity Center は、AWS Organizations と密接に連携し、組織全体のアクセス制御を一元的に管理する。

### 4. セキュリティと認証・認可

セキュリティは IAM Identity Center の中核コンポーネントです:

- **認証と認可**: IAM Identity Center は、ID プロバイダーを通じてユーザーを認証し、適切な権限を付与する。
- 多要素認証（MFA）\*\*: MFA を適用することで、セキュリティを強化する。
- 暗号化通信\*\*: ユーザー認証、アクセス許可のリクエスト、すべての通信は暗号化される。
- 監査ログ\*\*: ユーザーアクティビティのログを記録し、セキュリティ監査を可能にする。

これらのセキュリティ機能により、AWS 環境への安全なアクセスを実現する。

### 5. 料金形態

AWS IAM Identity Center 自体には追加料金はかかりません。  
このサービスは、AWS アカウントの利用料金に含まれています。

- **無料**: IAM Identity Center サービス自体は無料で使用できる。
- **関連サービスの料金**: AWS リソースへのアクセス時に、関連サービスの利用料金が発生する場合がある（例: EC2、S3 など）。

### 6. よくあるアーキテクチャ・設計パターン

一般的なパターンは以下の通りです:

- **複数 AWS アカウントの一元管理**: AWS Organizations と連携し、複数の AWS アカウントへのアクセスを IAM Identity Center で一元的に管理。
- IdP 連携\*\*: 既存の Active Directory や Okta などの IdP と連携して、企業のユーザーアカウントを AWS に活用。
- 多要素認証の適用\*\*: IAM Identity Center で MFA を設定し、AWS リソースへのアクセスセキュリティを強化。
- SAML 連携\*\*: SAML 2.0 対応のアプリケーションと連携し、AWS リソースへのシングルサインオンを実現。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS Management Console で IAM Identity Center のサービスを選択し、有効化。
2. ID ソース（AWS IAM Identity Center directory、外部 ID プロバイダー）を選択。
3. ユーザーやグループを IAM Identity Center に追加またはインポート。
4. ユーザーやグループに AWS アカウントへのアクセス権限を設定（Permission Sets）。
5. MFA を設定し、セキュリティを強化。
6. ユーザーが IAM Identity Center にログインし、割り当てられた AWS アカウントにアクセスできることを確認。

### 8. 試験で問われやすいポイント

#### 8.1 シングルサインオン (SSO) の概念

- **SSO**: 一度の認証で複数の AWS アカウントやアプリケーションにアクセス可能。
- **利点**: ユーザーの利便性向上、パスワード管理の簡略化、セキュリティ強化。

#### 8.2 ID プロバイダー (IdP) との連携

- **連携**: Microsoft Active Directory、Okta、Azure AD などの既存の IdP と連携。
- **プロトコル**: SAML 2.0、SCIM などの標準プロトコルを使用。

#### 8.3 AWS Organizations との統合

- **統合**: 組織内のすべての AWS アカウントへのアクセスを一元管理。
- **メリット**: 管理の一元化、アクセス制御の簡素化。

#### 8.4 アクセス制御と権限管理

- **Permission Sets**: AWS アカウントへのアクセス権限を定義、割り当て。
- **AWS Managed Policies**: AWS が提供する定義済みポリシー。
- **カスタムポリシー**: 柔軟なアクセス許可設定。

#### 8.5 多要素認証 (MFA)

- **MFA**: パスワードに加えて追加の認証要素を要求し、セキュリティを強化。
- **MFA オプション**: 仮想 MFA、物理 MFA、SMS など。

#### 8.6 料金体系

- **IAM Identity Center 自体**: 無料。
- **関連サービス**: AWS リソースの利用料金は発生。
- 試験問題では、以下がよく問われる。
  - 「IAM Identity Center の主な機能は？」
  - 「IdP 連携の仕組みは？」
  - 「AWS Organizations との統合方法は？」
  - 「料金体系は？」

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: AWS IAM Identity Center の主な機能は？
  - A: 複数の AWS アカウントやアプリケーションへのシングルサインオン、IdP 連携、一元的なアクセス管理。
- Q: IAM Identity Center で利用可能な ID プロバイダーとの連携プロトコルは？
  - A: SAML 2.0、SCIM。
- Q: IAM Identity Center は AWS Organizations とどのように連携するか？
  - A: 組織内の AWS アカウント全体に対して、アクセス権限を一元管理する。
- Q: IAM Identity Center の利用料金は？
  - A: サービス自体は無料。関連サービスの利用料金が発生する。
- Q: IAM Identity Center で多要素認証（MFA）を設定する目的は？
  - A: セキュリティを強化し、不正アクセスを防ぐため。
- Q: IAM Identity Center で AWS アカウントへのアクセス許可を付与するために使用する機能は？
  - A: Permission Sets。

---

## Amazon Cognito

### 1. サービス概要

Amazon Cognito は、Web アプリケーションやモバイルアプリケーションに、ユーザー認証、認可、およびユーザー管理機能を簡単に追加できるサービスである。  
ユーザーは、独自のユーザープールを管理したり、Facebook、Google、Amazon などのソーシャル ID プロバイダーを通じてユーザーを認証できる。  
Cognito は、認証プロセスの複雑さを軽減し、アプリケーションのセキュリティを向上させるための包括的なソリューションを提供する。

主なユースケースとして、

- Web アプリケーションの認証・認可
- モバイルアプリケーションの認証・認可
- ソーシャルログイン
- API のアクセス制御
- ユーザーデータ管理

などが挙げられます。  
Amazon Cognito は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 ユーザープール

ユーザープールは、アプリケーションのユーザーディレクトリとして機能する。  
ユーザーは、ユーザープールに登録し、認証情報を管理できる。

#### 2.2 ID プール

ID プールは、アプリケーションのユーザーに、AWS リソースへのアクセス権限を付与するための機能を提供する。  
ユーザーは、ID プールを通じて、一時的な AWS 認証情報を取得できる。

#### 2.3 ソーシャルログイン

Facebook, Google, Amazon, Apple などのソーシャル ID プロバイダーを利用して、ユーザーを認証できる。  
これにより、ユーザーは既存のアカウントでアプリケーションに簡単にログインできる。

#### 2.4 多要素認証 (MFA)

SMS、TOTP などの多要素認証（MFA）をサポートし、セキュリティを強化できる。  
これにより、ユーザーアカウントへの不正アクセスを防止できる。

#### 2.5 カスタマイズ可能な UI

サインアップ、ログイン、パスワードリセットなどのユーザーインターフェースをカスタマイズできる。  
これにより、アプリケーションのデザインに合わせた認証画面を作成できる。

#### 2.6 ユーザーデータ管理

ユーザー属性、グループ、ロールなどのユーザーデータを管理できる。  
API を通じて、ユーザーデータを取得したり、更新したりできる。

#### 2.7 統合性と拡張性

Amazon Cognito は、API Gateway, Lambda, S3, DynamoDB などの AWS の他のサービスと密接に統合されています。  
また、OAuth 2.0 や SAML 2.0 などの業界標準プロトコルをサポートしており、他のシステムとの連携も容易である。

### 3. アーキテクチャおよび技術要素

1. ユーザーは、アプリケーションから Cognito にサインアップまたはログインリクエストを送信。
2. Cognito は、ユーザーを認証し、ID トークンとアクセストークンを発行。
3. アプリケーションは、ID トークンとアクセストークンを使って、API や AWS リソースにアクセス。
4. 必要に応じて、ID プールを利用して、AWS 認証情報を取得。
5. Cognito は、ユーザーデータを管理し、認証ステータスを維持。

Amazon Cognito は、AWS のインフラ上に構築されており、高い可用性とスケーラビリティを提供する。  
認証やユーザー管理は AWS が行うため、ユーザーはインフラの管理を意識する必要はありません。

### 4. セキュリティと認証・認可

Amazon Cognito は、アプリケーションのセキュリティを確保するために、以下の機能を提供する:

- **ユーザー認証**: パスワード、多要素認証 (MFA)、ソーシャルログインなど、様々な認証方式をサポート。
- **ID トークンとアクセストークン**: JWT (JSON Web Token) を使用し、セキュアなトークンベース認証。
- **AWS リソースへのアクセス制御**: ID プールを使用して、一時的な AWS 認証情報を付与し、リソースへのアクセスを制御。
- **データ保護**: ユーザーデータは転送中および保存時に暗号化される。
- **アクセス制御**: IAM ポリシーを通じて、Cognito へのアクセス権限を詳細に制御できる。

これらのセキュリティ対策により、アプリケーションへの不正アクセスを防止し、機密情報を保護できる。

### 5. 料金形態

Amazon Cognito の料金は主に以下に基づきます:

- **ユーザー数**: ユーザープールに登録された月間のアクティブユーザー数に応じて課金。
- **認証**: 認証の回数に応じて課金。
- **ID プール**: ID プールを利用した場合の認証回数に応じて課金。
- **多要素認証 (MFA)**: MFA を利用した場合の SMS 送信などに応じて課金。

### 6. よくあるアーキテクチャ・設計パターン

Amazon Cognito は、様々なアプリケーションの認証と認可に利用できる。  
一般的なパターンは以下の通りです:

- **Web アプリケーションの認証・認可**: Web アプリケーションのユーザー認証、認可を Cognito で処理し、API Gateway と連携して API へのアクセスを制御。
- **モバイルアプリケーションの認証・認可**: モバイルアプリケーションのユーザー認証、認可を Cognito で処理し、API バックエンドにアクセス。
- **ソーシャルログイン**: Facebook、Google、Amazon などのソーシャル ID プロバイダーを利用し、ユーザーがアプリケーションに簡単にログインできるようにする。
- **API のアクセス制御**: API Gateway と Cognito を連携し、API へのアクセスを認証・認可。
- **ユーザーデータ管理**: ユーザーの属性、グループ、ロールなどを Cognito で一元管理。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから Amazon Cognito を開き、ユーザープールを作成。
2. アプリケーションクライアントを作成し、クライアント ID、クライアントシークレットを生成。
3. ソーシャル ID プロバイダー（Facebook、Google など）を設定。
4. ID プールを作成し、ユーザープールと連携。
5. アプリケーションで、Cognito SDK を使って、ユーザー登録、ログイン機能を実装。
6. API Gateway と Cognito を連携して、API のアクセスを制御。

### 8. 試験で問われやすいポイント

#### 8.1 ユーザープール

- **機能**: アプリケーションのユーザーディレクトリとして機能。
- **利用**: ユーザー登録、認証情報の管理。
- **試験対策**: ユーザープールの役割、利用ケースが問われる。

#### 8.2 ID プール

- **機能**: AWS リソースへのアクセス権限を付与。
- **利用**: 一時的な AWS 認証情報を取得。
- **試験対策**: ID プールの役割、認証情報の取得方法が問われる。

#### 8.3 ソーシャルログイン

- **対象**: Facebook, Google, Amazon, Apple など。
- **利点**: ユーザーは既存のアカウントで簡単にログイン可能。
- **試験対策**: ソーシャルログインのメリット、設定方法が問われる。

#### 8.4 多要素認証 (MFA)

- **種類**: SMS, TOTP など。
- **目的**: セキュリティを強化、不正アクセスを防止。
- **試験対策**: MFA の設定方法、重要性が問われる。

#### 8.5 料金体系

- **課金対象**: 月間のアクティブユーザー数、認証回数、ID プールの利用、MFA など。
- **最適化**: 不要な認証処理の削減、適切な MFA 設定がコスト削減に有効。
- **試験対策**: 料金体系、課金対象が問われる。

#### 8.6 類似・関連サービスとの比較

- **AWS IAM**: AWS リソースへのアクセス制御に特化。Cognito はアプリケーションのユーザー認証と認可に特化。
- **AWS Secrets Manager**: データベースの認証情報などを安全に管理。Cognito はユーザー認証に特化。

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: Amazon Cognito は何を提供するサービスですか？
  - A: Web アプリケーションやモバイルアプリケーションに、ユーザー認証、認可、およびユーザー管理機能を追加できるサービスである。
- Q: Amazon Cognito のユーザープールは何を管理するか？
  - A: アプリケーションのユーザーディレクトリとして機能し、ユーザーの認証情報を管理する。
- Q: Amazon Cognito の ID プールは何に使用するか？
  - A: アプリケーションのユーザーに AWS リソースへのアクセス権限を付与するために使用する。
- Q: Amazon Cognito でソーシャルログインを利用するには、どのような設定が必要であるか？
  - A: Facebook, Google, Amazon, Apple などのソーシャル ID プロバイダーを設定する必要がある。
- Q: Amazon Cognito の料金はどのように計算されるか？
  - A: ユーザープールに登録された月間のアクティブユーザー数、認証の回数、ID プールの利用、MFA などに基づいて計算される。

---

## Amazon Detective

### 1. サービス概要

Amazon Detective は、AWS 環境におけるセキュリティ調査を効率化するためのサービスである。  
ユーザーは、AWS リソースのログデータやアクティビティデータを自動的に収集、分析し、潜在的なセキュリティ問題を検出、調査、解決できる。  
Detective は、セキュリティインシデントの根本原因を特定し、脅威を迅速に特定、調査するための視覚的な分析ツールを提供する。

主なユースケースとして、

- セキュリティインシデントの調査
- 異常なアクティビティの検出
- 脅威のハンティング
- セキュリティ監査
- コンプライアンス遵守

などが挙げられます。  
Amazon Detective は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 セキュリティデータの自動収集

Detective は、AWS CloudTrail、VPC Flow Logs、GuardDuty などの AWS セキュリティサービスから、ログデータやアクティビティデータを自動的に収集する。  
これにより、ユーザーは手動でログを収集、管理する必要がなくなります。

#### 2.2 グラフデータベース

収集されたデータは、グラフデータベースに格納される。  
グラフデータベースは、エンティティ（ユーザー、IP アドレス、リソースなど）間の関係性を分析するのに適しており、セキュリティインシデントの根本原因を特定するのに役立ちます。

#### 2.3 視覚的な分析ツール

Detective は、視覚的な分析ツールを提供する。  
ユーザーは、グラフやタイムラインを使用して、セキュリティデータをインタラクティブに調査し、異常なアクティビティを検出できる。

#### 2.4 行動分析

機械学習を利用して、ユーザーやリソースの行動パターンを分析し、異常なアクティビティを検出する。  
これにより、潜在的な脅威を早期に特定できる。

#### 2.5 脅威のハンティング

Detective は、セキュリティアナリストが能動的に脅威を探索するための機能を提供する。  
ユーザーは、特定のエンティティやアクティビティに関するクエリを実行し、潜在的な脅威を検出できる。

#### 2.6 他の AWS サービスとの統合

Detective は、AWS Security Hub, Amazon GuardDuty, Amazon CloudWatch Logs などの他の AWS セキュリティサービスと統合できる。  
これにより、AWS 環境全体のセキュリティ状況を把握し、連携して対応できる。

#### 2.7 統合性と拡張性

AWS Detective は、AWS Organizations と統合し、組織全体のアカウントのセキュリティデータを分析できる。  
また、API を利用して、データの取得や分析を自動化することもできる。

### 3. アーキテクチャおよび技術要素

1. Detective は、AWS CloudTrail、VPC Flow Logs、GuardDuty などの AWS サービスからログデータを収集。
2. 収集したデータをグラフデータベースに保存し、エンティティ間の関係性を構築。
3. ユーザーは、Detective のコンソールでグラフやタイムラインを使用して、セキュリティデータを分析。
4. 機械学習を利用して、異常なアクティビティを検出。
5. ユーザーは、検出された脅威を調査し、対策を講じる。

Amazon Detective は、AWS のインフラ上に構築されており、高い可用性とスケーラビリティを提供する。  
セキュリティデータの収集や分析は AWS が行うため、ユーザーはインフラの管理を行う必要はありません。

### 4. セキュリティと認証・認可

Amazon Detective は、セキュリティデータのセキュリティを確保するために、以下の機能を提供する:

- **IAM 統合**: AWS Identity and Access Management (IAM) を利用して、Detective へのアクセスを制御する。
- **データ暗号化**: セキュリティデータは転送中および保存時に暗号化される。
- **VPC エンドポイント**: VPC 内から Detective にアクセスする際に、インターネットを経由せずにアクセスできる。
- **アクセス制御**: IAM ポリシーを通じて、ユーザーやグループごとに、Detective の操作権限を詳細に制御できる。
- **監査ログ**: CloudTrail を通じて、Detective の利用状況を監査できる。

これらのセキュリティ対策により、セキュリティデータへの不正アクセスを防止し、機密情報を保護できる。

### 5. 料金形態

Amazon Detective の料金は主に以下に基づきます:

- **分析データ量**: 分析対象となるイベントの量に応じて課金。
- **データ保存**: 収集されたデータを保存するストレージ容量に応じて課金。

### 6. よくあるアーキテクチャ・設計パターン

Amazon Detective は、様々なセキュリティ調査に利用できる。  
一般的なパターンは以下の通りです:

- **セキュリティインシデントの調査**: セキュリティインシデントが発生した場合に、Detective を利用して根本原因を特定。
- **異常なアクティビティの検出**: ユーザーやリソースの行動を分析し、異常なアクティビティを早期に発見。
- **脅威のハンティング**: セキュリティアナリストが積極的に脅威を探索するために Detective を利用。
- **セキュリティ監査**: 定期的にセキュリティデータを分析し、セキュリティリスクを評価。
- **コンプライアンス遵守**: セキュリティポリシーの遵守状況を監視し、コンプライアンス要件を満たすことを保証。
- **アカウント乗っ取りの調査**: 不正なアクセスを検出し、侵害されたアカウントを特定。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから Amazon Detective を開き、新しいグラフを作成。
2. 分析対象となるアカウント、リージョンを選択。
3. Detective が収集したセキュリティデータを確認。
4. グラフやタイムラインを使用して、セキュリティデータを調査。
5. 検出された異常なアクティビティを分析。

### 8. 試験で問われやすいポイント

#### 8.1 セキュリティデータの自動収集

- **収集元**: AWS CloudTrail, VPC Flow Logs, GuardDuty など。
- **特徴**: ユーザーは手動でログを収集、管理する必要がない。
- **試験対策**: 収集されるデータの種類、収集元サービスが問われる。

#### 8.2 グラフデータベース

- **特徴**: エンティティ間の関係性を分析するのに適している。
- **利用**: セキュリティインシデントの根本原因を特定。
- **試験対策**: グラフデータベースの利用目的、利点が問われる。

#### 8.3 視覚的な分析ツール

- **利用**: グラフやタイムラインを使用して、インタラクティブにデータを調査。
- **利点**: 異常なアクティビティを検出しやすく、調査を効率化。
- **試験対策**: 可視化されたデータの種類、分析方法が問われる。

#### 8.4 行動分析

- **利用技術**: 機械学習。
- **目的**: ユーザーやリソースの行動パターンを分析し、異常なアクティビティを検出。
- **試験対策**: 機械学習の利用目的、効果が問われる。

#### 8.5 料金体系

- **課金対象**: 分析データ量、データ保存。
- **最適化**: 不要なデータの収集を減らすことでコストを削減。
- **試験対策**: 料金体系、課金対象が問われる。

#### 8.6 類似・関連サービスとの比較

- **AWS Security Hub**: セキュリティの状態を統合的に管理するサービス。Detective はセキュリティ調査に特化。
- **Amazon GuardDuty**: 脅威検出サービス。Detective は GuardDuty の検出結果を調査。

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: Amazon Detective は何を提供するサービスですか？
  - A: AWS 環境におけるセキュリティ調査を効率化するためのサービスである。
- Q: Amazon Detective は、どのようなデータを自動的に収集するか？
  - A: AWS CloudTrail、VPC Flow Logs、GuardDuty などの AWS セキュリティサービスからログデータやアクティビティデータを収集する。
- Q: Amazon Detective は、収集したデータをどのように分析するか？
  - A: グラフデータベースにデータを格納し、視覚的な分析ツールや機械学習を利用して分析する。
- Q: Amazon Detective の料金はどのように計算されるか？
  - A: 分析対象となるイベントの量、収集されたデータを保存するストレージ容量に基づいて計算される。
- Q: Amazon Detective は、どのようなセキュリティ上の脅威を検出し、調査するのに役立ちますか？
  - A: セキュリティインシデント、異常なアクティビティ、アカウント乗っ取りなどを検出し、調査するのに役立ちます。

---

## Amazon GuardDuty

### 1. サービス概要

Amazon GuardDuty は、AWS アカウントやワークロードを継続的に監視し、異常な振る舞いや不正アクセスの兆候を検知するマネージド型の脅威検出サービスである。  
機械学習や脅威インテリジェンス（Threat Intelligence）を活用することで、セキュリティ運用の高度化および検知精度の向上を実現する。

主なユースケースとして、

- 外部からの不正アクセスや内部的なアカウント乱用の検知
- 暗号通貨マイニングなどの不審行為発見
- マルウェア感染兆候の早期検知

などが挙げられます。  
これらは、ログやイベントを自動的に分析し、重要度に基づいてアラートを上げることで迅速な対処が可能になります。

### 2. 主な特徴と機能

#### 2.1 脅威インテリジェンスを活用した検知

GuardDuty では、AWS が統合している AWS Security や外部機関の脅威インテリジェンス情報（悪意ある IP アドレス、ドメイン、ボットネットなど）を活用して、攻撃が疑われる通信を自動的に検知する。  
これにより、既知の不審活動や新種の脅威を大幅に早期発見できる。

- **Amazon 独自の脅威フィード**: 常にアップデートされる最新の脅威情報を反映
- **サードパーティとの連携**: Threat Intel（例: Proofpoint、CrowdStrike 等）を利用

#### 2.2 機械学習(ML)ベースの異常検知

GuardDuty は機械学習を用いて、通常とは異なるアクティビティや挙動（異常行動）を検出する機能を提供する。  
例えば、普段は使用しないリージョンからの急激な API コール増加や、アクセス履歴のないサービスでの大規模操作などを捉えて通知する。

#### 2.3 データソース(CloudTrail, VPC Flow Logs, DNS Logs)

GuardDuty は以下のログを収集・分析することで、脅威ハンティングや異常検知を実現する:

- **Amazon CloudTrail イベントログ**: AWS アカウントでの API コール履歴
- **VPC Flow Logs**: VPC 内部/外部へのネットワークトラフィックパターン
- **DNS Logs**: Route 53 Resolver DNS クエリのログ

これらを継続的にモニタリングし、不審なアクセスや通信パターンを素早く検知する。

#### 2.4 検出結果(Finding)とアラート

GuardDuty が脅威または疑わしい挙動を検知すると、Finding として結果を表示する。  
検出内容には重要度（Severity）が付与され、どのようなアクティビティが検知されたのかを詳細に確認できる。

#### 2.5 他 AWS サービスとの連携

GuardDuty は AWS Security Hub や Amazon EventBridge（旧 CloudWatch Events）などと連携することで、自動的な修復フローやチケット発行、メール通知などを実現できる。  
また、AWS Organizations を利用したマルチアカウント管理にも対応しているため、大規模環境でもセキュリティを一括管理できる。

### 3. アーキテクチャおよび技術要素

1. GuardDuty は、AWS 内部のログストリーミング基盤を通じて CloudTrail や VPC Flow Logs、DNS Logs を受け取り。
2. 機械学習エンジンや Threat Intelligence を用いて不審なイベントやアクセスパターンを検知。
3. 検出した脅威は Finding として GuardDuty コンソールに集約。
4. ユーザーはコンソールや EventBridge などを介してアラートを受け取り、自動または手動で対応。

これらのコンポーネントは AWS がフルマネージドで提供しており、ユーザーは検知精度を維持しつつ、複雑なログ解析基盤を自前で構築する必要がありません。

### 4. セキュリティと認証・認可

GuardDuty 自体はセキュリティサービスですが、サービスを利用するにあたっては以下のポイントが重要である:

- **IAM ロールによる権限付与**: GuardDuty を有効化する際、ログへの読み取り権限（CloudTrail、VPC Flow Logs など）を付与するための IAM ロールが使用される。
- **データ機密性の保持**: GuardDuty はログの内容を分析するが、TLS や暗号化された安全な通信を用い、処理は AWS 内部で完結。
- **マルチアカウントのアクセス制御**: AWS Organizations などを活用し、各メンバーアカウントのガバナンスを集中管理可能。

### 5. 料金形態

Amazon GuardDuty の料金は主に以下 2 つの要素に基づきます:

- **ログ分析量**: VPC Flow Logs、CloudTrail、DNS Logs などから収集したログの分析処理量に応じた従量課金。
- **サイジング**: アクティブなアカウント数や分析対象リージョン数により、全体のコストが変動。

### 6. よくあるアーキテクチャ・設計パターン

GuardDuty は脅威検知サービスですが、運用においては他サービスとの連携が鍵となる。  
一般的なパターンは以下の通りです:

- **Security Hub 連携**: GuardDuty の Finding を Security Hub で一元管理し、他のセキュリティサービス（Macie、Inspector など）との統合ビューを提供
- **EventBridge での自動対処**: GuardDuty の Finding をトリガーにして、Lambda を起動し自動修復アクション（例: 不審な EC2 インスタンスの隔離）を実行
- **組織全体でのガバナンス**: AWS Organizations を使用して、複数アカウントで GuardDuty を有効化し、集中管理アカウントで一元的に Finding を把握

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS コンソールで「Amazon GuardDuty」を検索し、サービスページへ移動
2. 「有効化(Enable GuardDuty)」ボタンをクリックし、初期設定を実施
3. 必要に応じて AWS Organizations によるマルチアカウント統合を設定
4. EventBridge ルールを作成して、特定の Severity 以上の Finding を検知したら SNS 通知や Lambda 実行などのアクションを紐づけ
5. GuardDuty コンソールに戻り、Finding が発生した際に正常に通知・対処フローが起動することを確認

### 8. 試験で問われやすいポイント

#### 8.1 データソースと脅威インテリジェンス

- **データソース**: CloudTrail、VPC Flow Logs、DNS Logs の分析が中心
- **Threat Intelligence**: 悪意のある IP やドメインに関する情報を定期的にアップデート
- **検知ロジック**: 機械学習やシグネチャベースの手法を組み合わせた総合的な脅威検知

#### 8.2 Finding の理解と Severity

- **Finding**: GuardDuty が検出した脅威・不審挙動を示すイベント
- **Severity**: 低・中・高などで分けられ、対応優先度を判断する指標
- **対処**: 記載されている推奨アクションに従い、リソースの隔離・IAM 権限の確認などを実施

#### 8.3 インシデント対応と自動化

- **EventBridge 連携**: GuardDuty の Finding 発生時に自動的に Lambda を呼び出す
- **Security Hub 統合**: Finding を集中管理し、全体のセキュリティステータスを可視化
- **対応フロー**: 不審 EC2 インスタンスの停止、ネットワーク ACL 更新などを迅速に実施

#### 8.4 マルチアカウント管理

- **Administrator Account/Member Account**: GuardDuty では一つのアカウントが管理者（Administrator）となり、他をメンバー（Member）として招待
- **AWS Organizations の活用**: GuardDuty を組織単位で自動オンボーディング可能
- **メリット**: セキュリティポリシーや Finding を一元管理し、対応漏れを防ぐ

#### 8.5 料金最適化

- **不要リージョンの無効化**: 利用しないリージョンで GuardDuty を停止してコスト削減
- **ログボリュームの把握**: どのアカウント、どのリージョンでどれだけのログが生成されているかを可視化し、異常に多い場合は原因を調査
- **サンプル分析設定**: POC や検証用に一時的に GuardDuty を有効化し、設計フェーズで概算コストを試算

#### 8.6 GuardDuty と他のセキュリティサービスとの比較

- **Amazon Macie**: S3 内の機密データ検出に特化。GuardDuty はネットワーク/アカウントの脅威検知
- **Amazon Inspector**: EC2 インスタンスやコンテナイメージの脆弱性をスキャン。GuardDuty は稼働中の不審挙動を検知
- **AWS WAF**: アプリケーションレイヤーの攻撃（SQL インジェクションなど）をブロック。GuardDuty は AWS リソース全般の脅威を広く監視

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: GuardDuty が分析する主なログソースは？
  - A: CloudTrail、VPC Flow Logs、DNS Logs。
- Q: GuardDuty で検出された不審挙動はどのように表示される？
  - A: Finding として表示され、Severity が付与される。
- Q: マルチアカウント環境で GuardDuty を一括管理する方法は？
  - A: AWS Organizations と Administrator/Member アカウントの設定を利用。
- Q: GuardDuty からの通知をトリガーに自動修復を行うには？
  - A: EventBridge（旧 CloudWatch Events）と Lambda を連携させる。
- Q: Security Hub との連携メリットは？
  - A: 他のセキュリティサービスの検出結果とあわせて一元管理・可視化できる。

---

## Amazon Inspector

### 1. サービス概要

Amazon Inspector は、AWS 環境におけるセキュリティ脆弱性や設定ミスを自動的に検出するサービスである。  
ユーザーは、EC2 インスタンス、コンテナイメージ、AWS Lambda 関数などのリソースを継続的にスキャンし、セキュリティの脆弱性や設定エラーを特定できる。  
Inspector は、セキュリティリスクを軽減し、アプリケーションのセキュリティ体制を強化するために役立ちます。

主なユースケースとして、

- EC2 インスタンスの脆弱性スキャン
- コンテナイメージの脆弱性スキャン
- AWS Lambda 関数の脆弱性スキャン
- セキュリティコンプライアンスの維持
- セキュリティリスクの低減

などが挙げられます。  
Amazon Inspector は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 自動脆弱性スキャン

Inspector は、EC2 インスタンス、コンテナイメージ、AWS Lambda 関数などのリソースを自動的にスキャンし、セキュリティ脆弱性を検出する。  
スキャンは、継続的に実行され、常に最新の脅威情報に基づいて脆弱性を評価する。

#### 2.2 パッケージ脆弱性の検出

オペレーティングシステムやアプリケーションのパッケージに存在する既知の脆弱性を検出する。  
これにより、ソフトウェアのセキュリティリスクを特定できる。

#### 2.3 ネットワーク脆弱性の検出

EC2 インスタンスのネットワーク設定を評価し、ポートやプロトコルの設定ミスによるセキュリティリスクを検出する。  
これにより、不要なポートの開放や、セキュリティグループの誤った設定を特定できる。

#### 2.4 設定ミスの検出

AWS リソースの設定を評価し、セキュリティのベストプラクティスに準拠していない設定ミスを検出する。  
これにより、S3 バケットの公開設定や IAM ポリシーの不備などを特定できる。

#### 2.5 レポーティング

検出された脆弱性や設定ミスに関する詳細なレポートを提供する。  
レポートには、脆弱性の説明、影響度、推奨される修正策などが含まれます。

#### 2.6 他の AWS サービスとの統合

Inspector は、AWS Security Hub、Amazon EventBridge, AWS Systems Manager などの他の AWS サービスと統合できる。  
これにより、セキュリティ情報を連携し、自動的に対応策を実行できる。

#### 2.7 統合性と拡張性

AWS Inspector は、AWS Organizations と統合し、組織全体のリソースのセキュリティ状況を一元管理できる。  
また、API を利用して、スキャンの実行や結果の取得を自動化することもできる。

### 3. アーキテクチャおよび技術要素

1. ユーザーは、Inspector でスキャン対象となる AWS リソースを選択。
2. Inspector は、選択されたリソースを自動的にスキャンし、脆弱性や設定ミスを検出。
3. 検出された脆弱性や設定ミスは、Inspector のレポートに記録。
4. 必要に応じて、他の AWS サービスと連携し、自動的な対応策を実行。
5. ユーザーは、レポートを確認し、推奨される修正策を実施。

Amazon Inspector は、AWS のインフラ上に構築されており、高い可用性とスケーラビリティを提供する。  
リソースのスキャンや分析は AWS が行うため、ユーザーはインフラの管理を行う必要はありません。

### 4. セキュリティと認証・認可

Amazon Inspector は、セキュリティデータを保護するために、以下の機能を提供する:

- **IAM 統合**: AWS Identity and Access Management (IAM) を利用して、Inspector へのアクセスを制御する。
- **データ暗号化**: スキャン結果や設定データは転送中および保存時に暗号化される。
- **VPC エンドポイント**: VPC 内から Inspector にアクセスする際に、インターネットを経由せずにアクセスできる。
- **アクセス制御**: IAM ポリシーを通じて、ユーザーやグループごとに、Inspector の操作権限を詳細に制御できる。
- **監査ログ**: CloudTrail を通じて、Inspector の利用状況を監査できる。

これらのセキュリティ対策により、セキュリティデータへの不正アクセスを防止し、機密情報を保護できる。

### 5. 料金形態

Amazon Inspector の料金は主に以下に基づきます:

- **EC2 インスタンススキャン**: スキャン対象となる EC2 インスタンスの数に応じて課金。
- **コンテナイメージスキャン**: スキャン対象となるコンテナイメージの数に応じて課金。
- **AWS Lambda 関数スキャン**: スキャン対象となる Lambda 関数の数に応じて課金。

### 6. よくあるアーキテクチャ・設計パターン

Amazon Inspector は、様々なセキュリティ評価に利用できる。  
一般的なパターンは以下の通りです:

- **EC2 インスタンスの脆弱性スキャン**: EC2 インスタンスのオペレーティングシステムやアプリケーションの脆弱性を検出。
- **コンテナイメージの脆弱性スキャン**: コンテナイメージに存在する脆弱性を検出し、セキュリティリスクを低減。
- **AWS Lambda 関数の脆弱性スキャン**: Lambda 関数に存在する脆弱性を検出。
- **セキュリティコンプライアンスの維持**: AWS 環境のセキュリティ設定を評価し、コンプライアンス要件を満たすことを確認。
- **セキュリティリスクの低減**: 検出された脆弱性や設定ミスを修正し、セキュリティリスクを低減。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから Amazon Inspector を開き、スキャン対象となるリソースを選択。
2. スキャンの実行頻度や設定を定義。
3. Inspector が自動的にスキャンを実行。
4. レポートを確認し、検出された脆弱性や設定ミスを分析。
5. 推奨される修正策を適用。

### 8. 試験で問われやすいポイント

#### 8.1 自動脆弱性スキャン

- **対象**: EC2 インスタンス、コンテナイメージ、AWS Lambda 関数。
- **頻度**: 継続的にスキャンを実行。
- **試験対策**: 自動スキャンのメリット、対象リソースが問われる。

#### 8.2 パッケージ脆弱性の検出

- **対象**: オペレーティングシステムやアプリケーションのパッケージ。
- **目的**: ソフトウェアのセキュリティリスクを特定。
- **試験対策**: パッケージ脆弱性の検出方法、重要性が問われる。

#### 8.3 ネットワーク脆弱性の検出

- **対象**: EC2 インスタンスのネットワーク設定。
- **目的**: ポートやプロトコルの設定ミスによるセキュリティリスクを検出。
- **試験対策**: ネットワーク設定の評価方法、検出対象が問われる。

#### 8.4 設定ミスの検出

- **対象**: AWS リソースの設定。
- **目的**: セキュリティのベストプラクティスに準拠していない設定ミスを検出。
- **試験対策**: 設定ミスの検出方法、検出対象が問われる。

#### 8.5 レポーティング

- **内容**: 脆弱性の説明、影響度、推奨される修正策。
- **利用**: 脆弱性の分析、対策の検討。
- **試験対策**: レポートの内容、利用方法が問われる。

#### 8.6 料金体系

- **課金対象**: スキャン対象となる EC2 インスタンス、コンテナイメージ、Lambda 関数の数。
- **最適化**: 不要なリソースのスキャンを避けることでコストを削減。
- **試験対策**: 料金体系、課金対象が問われる。

#### 8.7 類似・関連サービスとの比較

- **AWS Security Hub**: セキュリティの状態を統合的に管理するサービス。Inspector は脆弱性スキャンに特化。
- **Amazon GuardDuty**: 脅威検出サービス。Inspector は脆弱性や設定ミスを検出。

#### 8.8 試験で頻出となる具体的な問われ方と答え

- Q: Amazon Inspector は何を提供するサービスですか？
  - A: AWS 環境におけるセキュリティ脆弱性や設定ミスを自動的に検出するサービスである。
- Q: Amazon Inspector は、どのようなリソースをスキャンできるか？
  - A: EC2 インスタンス、コンテナイメージ、AWS Lambda 関数などのリソースをスキャンできる。
- Q: Amazon Inspector は、どのような脆弱性を検出できるか？
  - A: オペレーティングシステムやアプリケーションのパッケージに存在する既知の脆弱性、EC2 インスタンスのネットワーク設定の脆弱性などを検出できる。
- Q: Amazon Inspector は、どのようにセキュリティ設定ミスを検出するか？
  - A: AWS リソースの設定を評価し、セキュリティのベストプラクティスに準拠していない設定ミスを検出する。
- Q: Amazon Inspector の料金はどのように計算されるか？
  - A: スキャン対象となる EC2 インスタンス、コンテナイメージ、Lambda 関数の数に基づいて計算される。

---

## Amazon Macie

### 1. サービス概要

Amazon Macie は、機械学習を活用して AWS 環境内の機密データを自動的に検出、分類、保護するセキュリティサービスである。  
Macie は、個人識別情報（PII）や知的財産などの機密情報を識別し、データ漏洩や不正アクセスのリスクを軽減する。  
これにより、企業はデータのセキュリティとコンプライアンスを強化し、情報保護のための効果的な対策を講じることができる。

主なユースケースとして、

- データの機密性の評価
- コンプライアンス遵守の支援
- セキュリティインシデントの早期検出
- データアクセスの監視と制御

などが挙げられます。

### 2. 主な特徴と機能

#### 2.1 機械学習によるデータ検出と分類

Macie は機械学習アルゴリズムを使用して、Amazon S3 バケット内の機密データを自動的に検出し、分類する。  
これにより、手動でのデータ分類作業を削減し、高精度で機密データを識別できる。

#### 2.2 データの可視化とダッシュボード

Macie のダッシュボードは、データの機密性やセキュリティリスクの概要を視覚的に表示する。  
ユーザーはリアルタイムでデータの状況を把握し、必要な対策を迅速に講じることができる。

#### 2.3 アラートと通知機能

機密データに対する不正アクセスや異常な活動が検出された場合、Macie は自動的にアラートを発行し、関連する通知を送信する。  
これにより、セキュリティインシデントへの迅速な対応が可能となる。

#### 2.4 詳細なレポートと分析

Macie は、データの使用状況やセキュリティリスクに関する詳細なレポートを生成する。  
これにより、データ保護の状況を定期的に評価し、改善点を特定することができる。

#### 2.5 カスタムポリシーとルール

ユーザーは、自社のセキュリティポリシーやコンプライアンス要件に基づいたカスタムルールを設定できる。  
これにより、特定の条件に合致するデータに対して自動的に対策を講じることが可能である。

#### 2.6 API および SDK の提供

Macie は API および SDK を提供しており、他の AWS サービスやサードパーティツールと統合することができる。  
これにより、データ保護プロセスの自動化やカスタムソリューションの構築が容易になります。

#### 2.7 リアルタイムデータモニタリング

Macie はリアルタイムでデータの使用状況をモニタリングし、異常な活動を即座に検出する。  
これにより、データ漏洩や不正アクセスのリスクを最小限に抑えることができる。

#### 2.8 連携機能

Macie は AWS Security Hub、Amazon GuardDuty、AWS Lambda などの他のセキュリティサービスと連携し、包括的なセキュリティ管理を実現する。  
これにより、セキュリティインシデントへの統合的な対応が可能となる。

### 3. アーキテクチャおよび技術要素

1. ユーザーは AWS Management Console、AWS CLI、または AWS SDK を使用して Amazon Macie を設定。
2. Macie は Amazon S3 バケットをスキャンし、機密データを検出・分類。
3. 機密データの検出結果は Macie ダッシュボードに表示され、ユーザーに可視化される。
4. 異常なデータアクセスやセキュリティリスクが検出された場合、アラートが発行され、通知が送信される。
5. CloudWatch や SNS と連携して、リアルタイムのアラートや通知を設定。
6. API を介して他のセキュリティツールやカスタムアプリケーションと統合し、自動化された対応プロセスを構築。
7. レポート機能を使用して、定期的なデータ保護状況の分析と評価を実施。
8. 必要に応じて、IAM ポリシーを設定し、Macie へのアクセスを制御。

Amazon Macie のアーキテクチャは、AWS の各種サービスとシームレスに統合されており、高い可用性とスケーラビリティを備えています。  
機械学習を活用したデータ検出とリアルタイムのモニタリングにより、ユーザーは常に最適なデータ保護状態を維持できる。

### 4. セキュリティと認証・認可

Amazon Macie は、データの機密性とセキュリティを確保するために、以下のセキュリティ機能を提供している：

- **AWS Identity and Access Management (IAM)**: ユーザーやグループごとに Macie へのアクセス権限を詳細に設定。最小権限の原則に基づいたポリシー管理が可能。
- **データ暗号化**: Macie によって処理されるデータは、転送中および保存時に暗号化され、データの機密性を確保。
- \*\*監査ログ: AWS CloudTrail と連携し、Macie へのアクセスや操作を詳細に記録。監査やセキュリティ分析に利用。
- \*\*多要素認証 (MFA): Macie 管理コンソールへのアクセスに MFA を要求し、アカウントのセキュリティを強化。
- \*\*セキュリティポリシーの適用: ユーザーやグループに対してセキュリティポリシーを適用し、一貫性のあるセキュリティ管理を実現。
- \*\*コンプライアンス対応: HIPAA、PCI DSS、GDPR などの業界標準に準拠したデータ保護機能を提供。
- \*\*リアルタイムモニタリング: データアクセスや操作をリアルタイムで監視し、不正な活動を迅速に検出。
- \*\*セキュリティインシデント対応: 異常なデータアクセスが検出された際に、自動的に対応プロセスをトリガー。

これらのセキュリティ機能により、Amazon Macie は組織のデータ保護ポリシーやコンプライアンス要件を満たし、安全かつ信頼性の高いデータ管理を実現する。

### 5. 料金形態

Amazon Macie の料金は、以下の要素に基づいています：

- **データスキャン量**: Amazon S3 バケット内のデータをスキャンした量に基づく従量課金。
- **機密データ検出**: 機密データを検出した際の追加料金。
- **レポート生成**: 詳細なレポートや分析を生成する際の料金。
- **カスタムルールの設定**: カスタムルールを設定してデータを分類・保護する際の料金。
- **API リクエスト**: Macie の API を使用してデータを取得・管理する際の料金。
- **サポートプラン**: AWS サポートプラン（Developer、Business、Enterprise）に応じて、追加のサポートや機能が提供される。
- **データ転送費用**: S3 バケット間やリージョン間のデータ転送に対する料金。

### 6. よくあるアーキテクチャ・設計パターン

一般的なパターンは以下の通りです：

- **機密データの自動検出と分類**: Macie を使用して S3 バケット内の機密データを自動的に検出し、分類する。
- **リアルタイムセキュリティモニタリング**: Macie のアラート機能を活用して、リアルタイムでデータアクセスの異常を検出・対応。
- **コンプライアンス遵守の支援**: GDPR や HIPAA などの規制要件を満たすために、Macie のレポート機能を活用。
- **データ漏洩防止（DLP）**: Macie を DLP ツールとして使用し、機密データの不正なアクセスや転送を防止。
- **統合セキュリティ管理**: AWS Security Hub や Amazon GuardDuty と連携し、統合的なセキュリティ管理を実現。
- **自動化された対応プロセス**: AWS Lambda や Step Functions と連携し、セキュリティインシデントに対する自動化された対応プロセスを構築。
- **マルチリージョンデータ保護**: 複数の AWS リージョンにわたるデータを Macie で保護し、統一されたセキュリティポリシーを適用。
- **カスタムルールの活用**: 特定のビジネス要件に基づいたカスタムルールを設定し、データ保護を強化。
- **ユーザーセルフサービスポータル**: ユーザーが自身のデータ保護状況を確認し、必要な設定をセルフサービスで行えるようにする。
- **継続的なセキュリティ評価**: 定期的なセキュリティチェックを実施し、データ保護の継続的な改善を図る。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS Management Console にログインし、Amazon Macie を開く。
2. 初回セットアップウィザードに従い、Macie を有効化する。
3. Amazon S3 バケットを選択し、Macie によるデータスキャンを設定。
4. スキャンするデータの種類（例: PII、知的財産）を選択し、カスタムルールを設定。
5. スキャンのスケジュールを設定し、定期的なデータスキャンを自動化。
6. CloudWatch や SNS と連携し、スキャン結果やアラートの通知先を設定。
7. IAM ポリシーを設定し、Macie へのアクセス権限を管理。
8. 機密データが検出された際の対応プロセスを定義し、Lambda 関数を作成。
9. Step Functions を使用して、セキュリティインシデントに対するワークフローを構築。
10. Macie ダッシュボードでスキャン結果を確認し、必要な対策を実施。
11. 詳細なレポートを生成し、データ保護状況を評価。
12. セキュリティポリシーに基づいて、アクセス権限やデータ分類を調整。
13. API を使用して、Macie のデータをカスタムアプリケーションと統合。
14. ユーザーセルフサービス機能を有効化し、ユーザーが自身のデータ保護状況を確認できるように設定。
15. 監査ログを CloudTrail に送信し、アクセス活動を記録。
16. セキュリティインシデント対応の自動化スクリプトをテストし、正しく動作することを確認。
17. リソースのバックアップとリカバリプロセスを設定。
18. Macie の設定を定期的にレビューし、最新のセキュリティ要件に合わせて調整。
19. チーム内で Macie の使用方法とベストプラクティスを共有。
20. 必要に応じて、追加のセキュリティポリシーやガードレールを適用。
21. 定期的なセキュリティ評価を実施し、データ保護の継続的な改善を図る。

このハンズオン例では、Amazon Macie の基本的な設定からデータスキャン、アラート設定、セキュリティインシデント対応の自動化までの一連の手順を通じて、Macie の主要機能を実際に体験できる。

### 8. 試験で問われやすいポイント

#### 8.1 Macie の基本概念

- **データ検出と分類**: Macie が S3 バケット内の機密データを自動的に検出・分類する仕組み。
- **ベストプラクティス**: Macie が提供するデータ保護のベストプラクティス。
- **試験例**: 「Macie の主な機能は何か？」、「データ分類のプロセスは？」など。

#### 8.2 データスキャンと分類

- **S3 バケットのスキャン**: Macie が S3 バケットをスキャンして機密データを検出する方法。
- **カスタムルールの設定**: 特定のビジネス要件に基づいたデータ分類ルールの設定方法。
- **試験例**: 「Macie で S3 バケットをスキャンする手順は？」、「カスタムルールを設定する方法は？」など。

#### 8.3 アラートと通知

- **アラートの設定**: 機密データに対する異常なアクセスが検出された際にアラートを発行する方法。
- **通知の連携**: SNS や Lambda と連携してアラートを通知する方法。
- **試験例**:
  - 「アラートを設定する手順は？」
  - 「SNS と連携する利点は？」...など。

#### 8.4 セキュリティポリシーの適用

- **ポリシーの作成**: Macie でデータ保護ポリシーを作成し、適用する方法。
- **最小権限の原則**: ユーザーやグループに必要最低限のアクセス権限を付与する方法。
- **試験例**:
  - 「セキュリティポリシーを作成する手順は？」
  - 「最小権限の原則を適用する方法は？」...など。

#### 8.5 コンプライアンスと規制遵守

- **規制要件の遵守**: HIPAA、PCI DSS、GDPR などの規制要件を満たすために Macie を活用する方法。
- **レポート機能**: コンプライアンスレポートを生成し、監査に対応する方法。
- **試験例**:
  - 「Macie を使用して GDPR に準拠する方法は？」
  - 「コンプライアンスレポートを生成する手順は？」...など。

#### 8.6 API と自動化

- **Macie API の利用**: Macie の API を使用してデータ検出結果を取得・管理する方法。
- **自動化された対応プロセス**: Lambda や Step Functions と連携して、セキュリティインシデントに対する自動対応を構築する方法。
- **試験例**:
  - 「Macie API を使用してデータ検出結果を取得する方法は？」
  - 「Lambda と連携して自動対応プロセスを構築する手順は？」...など。

#### 8.7 レポートとダッシュボードの活用

- **ダッシュボードのカスタマイズ**: Macie ダッシュボードをカスタマイズして、必要な情報を表示する方法。
- **詳細レポートの生成**: データ保護状況に関する詳細なレポートを生成し、分析する方法。
- **試験例**:
  - 「Macie ダッシュボードをカスタマイズする方法は？」
  - 「詳細レポートを生成する手順は？」...など。

#### 8.8 セキュリティインシデント対応

- **インシデント対応プロセスの構築**: Macie のアラートを基に、セキュリティインシデント対応プロセスを構築する方法。
- **自動対応の実装**: Lambda 関数や Step Functions を使用して、インシデント発生時に自動的に対応する方法。
- **試験例**:
  - 「インシデント対応プロセスを構築する手順は？」
  - 「自動対応を実装する方法は？」...など。

#### 8.9 試験で頻出となる具体的な問われ方と答え

- Q: Amazon Macie の主な目的は何か？
  - A: AWS 環境内の機密データを自動的に検出・分類し、データ漏洩や不正アクセスのリスクを軽減すること。
- Q: Macie が機密データを検出する方法は？
  - A: 機械学習アルゴリズムを使用して、S3 バケット内のデータをスキャンし、機密データを自動的に検出・分類する。
- Q: Macie と CloudTrail の連携の利点は何か？
  - A: Macie が検出したデータアクセスのログを CloudTrail に記録することで、監査やセキュリティ分析が容易になる。
- Q: Macie でカスタムルールを設定する方法は？
  - A: Macie の設定画面でカスタムルールを作成し、特定のデータパターンや条件に基づいてデータを分類・保護する。
- Q: Macie のレポート機能を活用する方法は？
  - A: Macie ダッシュボードからレポートを生成し、データ保護状況やセキュリティリスクに関する詳細な分析を実施する。

---

## AWS Artifact

### 1. サービス概要

AWS Artifact は、AWS のセキュリティおよびコンプライアンスに関するドキュメントを提供するサービスである。  
ユーザーは、AWS の監査レポート、認定証、契約書などをダウンロードし、自社のコンプライアンス要件を満たすために利用できる。  
AWS Artifact は、透明性と信頼性を提供し、AWS の利用に関するセキュリティとコンプライアンスに関する情報を容易に入手できるようにする。

主なユースケースとして、

- AWS のセキュリティ監査への対応
- コンプライアンス要件の確認
- 契約内容の確認
- AWS のセキュリティ体制の把握

などが挙げられます。  
AWS Artifact は、これらのユースケースに対応するための様々なドキュメントと、AWS の他のサービスとの連携を提供する。

### 2. 主な特徴と機能

#### 2.1 オンデマンドドキュメントへのアクセス

AWS Artifact は、AWS のセキュリティとコンプライアンスに関するドキュメントをオンデマンドで提供する。  
ユーザーは、必要な時にいつでも最新のドキュメントにアクセスできる。

#### 2.2 監査レポート

AWS のセキュリティとコンプライアンスに関する監査レポート（SOC 1, SOC 2, SOC 3, PCI DSS など）を提供する。  
これらのレポートは、AWS がセキュリティとコンプライアンスの基準を満たしていることを証明するものである。

#### 2.3 認定証

ISO 27001, FedRAMP, HIPAA などの業界標準や規制に準拠した AWS の認定証を提供する。  
これにより、ユーザーは AWS のセキュリティ体制を評価しやすくなります。

#### 2.4 契約書

AWS のサービスに関する契約書（ビジネスアソシエイト契約など）を提供する。  
これにより、AWS との契約内容を確認し、ビジネス要件を満たすことを保証できる。

#### 2.5 セキュリティガイドライン

AWS のセキュリティに関するベストプラクティスやガイドラインを提供する。  
これにより、AWS のセキュリティ設定を適切に行うことができる。

#### 2.6 アクセス制御

IAM ポリシーを利用して、AWS Artifact へのアクセスを制御できる。  
特定のユーザーやグループに対して、ドキュメントの閲覧やダウンロードの権限を付与できる。

#### 2.7 統合性と拡張性

AWS Artifact は、AWS Organizations と統合し、組織全体のアカウントのドキュメントにアクセスできる。  
また、API を利用して、ドキュメントの取得を自動化することもできる。

### 3. アーキテクチャおよび技術要素

1. ユーザーは、AWS マネジメントコンソールまたは API を通じて、AWS Artifact にアクセス。
2. AWS Artifact は、セキュリティ、コンプライアンスに関するドキュメントを保管。
3. ユーザーは、必要なドキュメントを検索し、閲覧またはダウンロード。
4. アクセス制御は、IAM ポリシーによって管理。

AWS Artifact は、AWS のインフラ上に構築されており、高い可用性と信頼性を提供する。  
ドキュメントの管理は AWS が行うため、ユーザーはインフラの管理を行う必要はありません。

### 4. セキュリティと認証・認可

AWS Artifact は、ドキュメントのセキュリティを確保するために、以下の機能を提供する:

- **IAM 統合**: AWS Identity and Access Management (IAM) を利用して、AWS Artifact へのアクセスを制御する。
- **アクセス制御**: IAM ポリシーを通じて、ユーザーやグループごとに、ドキュメントの閲覧やダウンロードの権限を詳細に制御できる。
- **監査ログ**: CloudTrail を通じて、AWS Artifact の利用状況を監査できる。

これらのセキュリティ対策により、ドキュメントへの不正アクセスを防止し、機密情報を保護できる。

### 5. 料金形態

AWS Artifact は、無料で利用できるサービスである。

### 6. よくあるアーキテクチャ・設計パターン

AWS Artifact は、様々なコンプライアンスやセキュリティニーズに対応するために利用できる。  
一般的なパターンは以下の通りです:

- **AWS のセキュリティ監査への対応**: 監査機関への提出が必要な AWS の監査レポートを AWS Artifact から入手。
- **コンプライアンス要件の確認**: PCI DSS, HIPAA, ISO 27001 などのコンプライアンス要件を満たしていることを AWS Artifact で確認。
- **契約内容の確認**: AWS のサービスに関する契約書を AWS Artifact からダウンロードし、契約内容を確認。
- **AWS のセキュリティ体制の把握**: AWS のセキュリティに関するベストプラクティスやガイドラインを AWS Artifact から取得。
- **ベンダーリスク管理**: AWS のセキュリティ体制を評価し、ベンダーリスクを管理。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから AWS Artifact を開き、利用規約に同意。
2. 必要なドキュメント（監査レポート、認定証、契約書など）を検索。
3. ドキュメントを閲覧し、必要に応じてダウンロード。
4. IAM ポリシーを設定し、AWS Artifact へのアクセス権限を制御。

### 8. 試験で問われやすいポイント

#### 8.1 オンデマンドドキュメントへのアクセス

- **機能**: AWS のセキュリティとコンプライアンスに関するドキュメントをオンデマンドで提供。
- **利用**: 必要な時にいつでも最新のドキュメントにアクセス可能。
- **試験対策**: オンデマンドアクセスのメリット、利用方法が問われる。

#### 8.2 監査レポート

- **種類**: SOC 1, SOC 2, SOC 3, PCI DSS など。
- **目的**: AWS がセキュリティとコンプライアンスの基準を満たしていることを証明。
- **試験対策**: 各監査レポートの目的、内容が問われる。

#### 8.3 認定証

- **種類**: ISO 27001, FedRAMP, HIPAA など。
- **目的**: AWS のセキュリティ体制を評価。
- **試験対策**: 各認定証の対象範囲、重要性が問われる。

#### 8.4 契約書

- **内容**: AWS のサービスに関する契約書（ビジネスアソシエイト契約など）。
- **利用**: AWS との契約内容を確認。
- **試験対策**: 契約書の種類、確認すべき内容が問われる。

#### 8.5 料金体系

- **料金**: AWS Artifact は無料で利用可能。
- **重要性**: 無料で利用できることを理解しておく。
- **試験対策**: 料金に関する正しい知識が問われる。

#### 8.6 類似・関連サービスとの比較

- **AWS IAM**: AWS リソースへのアクセス制御サービス。Artifact はドキュメントを提供するサービス。
- **AWS Security Hub**: セキュリティの状態を統合的に管理するサービス。Artifact はセキュリティとコンプライアンスに関するドキュメントを提供。

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: AWS Artifact は何を提供するサービスですか？
  - A: AWS のセキュリティおよびコンプライアンスに関するドキュメントを提供するサービスである。
- Q: AWS Artifact で提供される監査レポートには、どのような種類があるか？
  - A: SOC 1, SOC 2, SOC 3, PCI DSS などの監査レポートを提供する。
- Q: AWS Artifact で提供される認定証には、どのような種類があるか？
  - A: ISO 27001, FedRAMP, HIPAA などの業界標準や規制に準拠した認定証を提供する。
- Q: AWS Artifact で提供される契約書には、どのようなものがあるか？
  - A: AWS のサービスに関する契約書（ビジネスアソシエイト契約など）を提供する。
- Q: AWS Artifact の利用料金は？
  - A: 無料で利用できる。

---

## AWS Audit Manager

### 1. サービス概要

AWS Audit Manager は、AWS 上で運用するシステムやアプリケーションの監査プロセスを自動化・効率化するサービスである。  
フレームワーク別（例: ISO、PCI DSS、SOC2 など）の監査要件に沿ったコントロールの設計と証跡収集を自動化し、監査レポート作成を簡素化できる点が大きな特徴である。

主なユースケースとして、

- コンプライアンスや内部統制が必要な組織での継続的監査管理
- 外部監査対応時の証跡・レポート提出

に活用される。  
Audit Manager により、オンプレミス中心の従来型監査プロセスを大幅に省力化でき、AWS アカウント横断の監査も効率的に行える。

### 2. 主な特徴と機能

#### 2.1 フレームワークベースのコントロールライブラリ

PCI DSS、ISO、SOC、HIPAA などの主要フレームワークに対応したテンプレートが用意されており、これらが提供する監査要件（コントロール）に対して自動的に関連する AWS の設定や利用状況をマッピングする。  
既存テンプレートをベースに、独自の基準や社内ルールを加えたカスタムフレームワークの作成も可能である。

- **テンプレートの活用**: グローバル標準の監査項目を網羅し、監査計画の立ち上げがスムーズ
- **カスタムフレームワーク**: 企業独自の要件や法規制を組み込み可能

#### 2.2 自動証跡収集(AWS Config, CloudTrail 連携)

Audit Manager は AWS リソースの設定変更ログ(AWS Config)や API コールログ(CloudTrail)などを自動収集し、各コントロールへの適合性を検証するエビデンス（証跡）として格納する。  
これにより、手動でのログ収集やスクリーンショット取得を最小化し、継続的な監査準備を実現する。

#### 2.3 リアルタイム評価とステータス管理

有効化したフレームワークに対し、AWS アカウントを継続的にモニタリングすることで、コンプライアンス状態のリアルタイム評価が可能である。  
ダッシュボードから不足している証跡や、要改善のコントロールを把握し、早期に対応が行える。

#### 2.4 監査レポート作成

収集したエビデンスをもとに、監査用レポートを自動生成する。  
レポートは特定フレームワークへの適合状況をまとめて提出できるため、外部監査人とのコミュニケーションを容易にし、監査プロセス全体を効率化する。

#### 2.5 マルチアカウント管理と Security Hub 連携

AWS Organizations と連携して、複数の AWS アカウントをまとめて監査フレームワークのスコープに含めることができる。  
また、AWS Security Hub の脆弱性情報などをエビデンスとして組み込むことで、セキュリティ面を含めた監査の包括的評価を行える。

### 3. アーキテクチャおよび技術要素

1. 監査対象フレームワークを選択（PCI DSS/ISO/SOC2 など）
2. 対象アカウントやリージョン、AWS サービスをスコープに追加
3. AWS Audit Manager が Config や CloudTrail などから証跡を継続的に収集
4. 各コントロールの適合状況を Audit Manager ダッシュボードで可視化
5. 最終的にレポートを生成し、エビデンスを外部監査人へ提出

これらの収集および評価プロセスはフルマネージドで行われ、ユーザーの手動作業を大幅に削減する。

### 4. セキュリティと認証・認可

Audit Manager の利用にあたり重要なポイントは以下の通りです:

- **IAM ポリシー**: Audit Manager がリソース情報やログを取得するために必要な最小限の権限を与える
- **暗号化・データ保護**: 収集された証跡データは AWS 内部で安全に保管され、利用者はアクセス権限を制御可能
- **組織統合**: AWS Organizations で複数アカウントにわたる監査を行う場合、Administrator/Member アカウントの設定を踏まえて権限を管理

### 5. 料金形態

AWS Audit Manager の料金は主に以下の項目で構成されています:

- **評価対象リソース数**: アセスメントに登録されたリソースの数や使用する証跡収集ポイントに基づく従量課金
- **継続的モニタリングコスト**: アカウント数や監査範囲が拡大すると、収集・保管するログ量により費用が変動
- **レポート生成**: エビデンス容量やレポートの生成頻度に左右される可能性あり

### 6. よくあるアーキテクチャ・設計パターン

Audit Manager を導入することで、監査作業やコンプライアンス確保が大幅に効率化される。  
一般的な活用パターンは以下の通りです:

- **コンプライアンス強化**: PCI DSS、ISO27001、SOC2 などの国際規格要件を常に満たすため、継続的モニタリングと定期レポート発行を自動化
- **内部監査の効率化**: 監査チームがバラバラに実施していた証跡収集を一元化し、監査手順の標準化を実現
- **Security Hub 連携**: GuardDuty や Inspector など他の AWS セキュリティサービスで検知された脆弱性情報を証跡に取り込み、監査対応範囲を拡大
- **マルチアカウント一括管理**: 大規模組織の全 AWS アカウントを対象に、テンプレートベースでの監査項目適用とエビデンス確認

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS コンソールで「AWS Audit Manager」を検索し、サービスにアクセス
2. 「Create assessment」をクリックし、監査のベースとなるフレームワークを選択（例: PCI、ISO）
3. 監査スコープとして対象の AWS アカウントやサービスを指定
4. 必要に応じてカスタムフレームワークやコントロールを追加・編集
5. 作成完了後、自動収集される証跡（Evidence）を確認し、レポートを生成

### 8. 試験で問われやすいポイント

#### 8.1 フレームワークとコントロール

- **テンプレート**: PCI DSS、ISO、SOC2 など主要規格に沿った要件が既に用意されている
- **カスタマイズ**: 企業独自のポリシーを追加したり、既存コントロールを編集することで柔軟に対応
- **マッピング**: Audit Manager が AWS リソースとフレームワーク要件を紐付け、証跡を自動収集

#### 8.2 証跡(Evidence)の取得と管理

- **自動収集**: Config や CloudTrail、Security Hub など AWS サービスからログを集約
- **エビデンスダッシュボード**: どのコントロールに対してどの証跡が不足しているかを可視化
- **エビデンスの活用**: レポート作成や外部監査対応でまとめて証跡を提示可能

#### 8.3 レポート生成

- **継続的監査**: 監査期間を設定し、自動的にレポートを作成
- **形式**: CSV や PDF などで出力し、監査人に提出
- **監査効率化**: エビデンスとコントロールが直接リンクされており、書類作業を最小化

#### 8.4 マルチアカウント管理

- **Administrator/Member アカウント**: 組織の監査担当者が一括で設定・管理
- **スコープ設定**: 必要なアカウントのみを対象にし、コストやノイズを削減
- **Org 連携のメリット**: 全社レベルで統一した監査ポリシーを適用

#### 8.5 他サービスとの連携

- **Security Hub**: 脆弱性やセキュリティリスクを Audit Manager の証跡に反映
- **Config**: リソース設定変化を自動検知し、監査レポートへ
- **CloudTrail**: API コールやユーザー操作履歴の証跡連携

#### 8.6 料金最適化

- **監査スコープの制限**: 必要なアカウント、サービスに絞ってアセスメントを作成
- **不要フレームワークの無効化**: 利用しない監査テンプレートを適用しないことでコストを抑制
- **証跡保存期間**: 必要に応じて保存期間を設定し、ストレージコストを調整

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: Audit Manager が自動的に収集する証跡の代表例は？
  - A: AWS Config、CloudTrail、Security Hub などのログ情報。
- Q: 主要な監査フレームワークをどのように設定する？
  - A: Audit Manager のテンプレートを使ってアセスメントを作成し、コントロールをマッピング。
- Q: Audit Manager と AWS Organizations の関係は？
  - A: 複数アカウントに対する監査範囲を一元管理し、管理者アカウントから構成を集約。
- Q: 監査レポートを生成した後、どのように活用できる？
  - A: 外部監査人とのやり取りや社内コンプライアンスチームへの報告に利用。
- Q: Audit Manager で費用を最適化するには？
  - A: 必要最低限のアセスメントスコープ設定や不要フレームワークの無効化、証跡保持期間の調整など。

---

## AWS Certificate Manager (ACM)

### 1. サービス概要

AWS Certificate Manager (ACM) は、AWS のサービスおよびプライベートネットワークで使用する SSL/TLS 証明書のプロビジョニング、管理、デプロイを容易にするサービスである。  
ユーザーは、証明書の取得、更新、管理を自動化し、アプリケーションのセキュリティを強化できる。  
ACM は、証明書のライフサイクル全体を管理し、手動での証明書管理に伴う複雑さを軽減する。

主なユースケースとして、

Web サイトの HTTPS 化
API Gateway の HTTPS エンドポイント設定
ロードバランサーの HTTPS リスナー設定
CloudFront ディストリビューションの HTTPS 設定
プライベート CA の運用

などが挙げられます。  
AWS Certificate Manager は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 パブリック SSL/TLS 証明書

ACM は、AWS のサービス（ELB, CloudFront, API Gateway など）で使用するパブリック SSL/TLS 証明書を無料でプロビジョニング、管理できる。  
証明書の取得、更新、デプロイを自動化し、手動での作業を削減できる。

#### 2.2 プライベート SSL/TLS 証明書

AWS Private CA と連携して、プライベートネットワークで使用するプライベート SSL/TLS 証明書を発行できる。  
これにより、企業内のシステムやアプリケーション間の通信を安全に保護できる。

#### 2.3 自動更新

ACM は、パブリック SSL/TLS 証明書の更新を自動的に行います。  
これにより、証明書の有効期限切れによるサービスの停止を防ぎ、証明書の管理負担を軽減できる。

#### 2.4 証明書のインポート

他の認証局で取得した SSL/TLS 証明書を ACM にインポートして利用できる。  
これにより、既存の証明書を AWS 環境で再利用できる。

#### 2.5 証明書のデプロイ

ACM でプロビジョニングした証明書を、ロードバランサー、CloudFront ディストリビューション、API Gateway などの AWS サービスに簡単にデプロイできる。  
証明書のデプロイは、数クリックで完了する。

#### 2.6 検証方法

ACM は、DNS 検証とメール検証という 2 つの証明書検証方法をサポートしている。  
DNS 検証は、CNAME レコードを追加することで証明書を検証する方法であり、メール検証は、指定したメールアドレスに送信されるメールを確認することで証明書を検証する方法である。

#### 2.7 統合性と拡張性

AWS ACM は、Elastic Load Balancer (ELB), Amazon CloudFront, Amazon API Gateway, AWS Elastic Beanstalk などの AWS の他のサービスと密接に統合されています。  
また、API を利用して、証明書の管理を自動化することもできる。

### 3. アーキテクチャおよび技術要素

1. ユーザーは、AWS マネジメントコンソールまたは API を通じて、ACM に証明書をリクエスト。
2. ACM は、証明書をプロビジョニングし、ドメインの所有権を検証（DNS 検証またはメール検証）。
3. ACM は、プロビジョニングした証明書を、ロードバランサー、CloudFront、API Gateway などの AWS サービスにデプロイ。
4. 証明書は、自動的に更新され、可用性とセキュリティを確保。

AWS ACM は、AWS のインフラ上に構築されており、高い可用性と信頼性を提供する。  
証明書のプロビジョニング、管理、デプロイは AWS が行うため、ユーザーは手動で証明書を管理する必要はありません。

### 4. セキュリティと認証・認可

AWS Certificate Manager は、証明書と鍵のセキュリティを確保するために、以下の機能を提供する:

- **IAM 統合**: AWS Identity and Access Management (IAM) を利用して、ACM へのアクセスを制御する。
- **データ暗号化**: 秘密鍵は、ハードウェアセキュリティモジュール（HSM）で保護され、暗号化される。
- **アクセス制御**: IAM ポリシーを通じて、ユーザーやグループごとに、ACM の操作権限を詳細に制御できる。
- **監査ログ**: CloudTrail を通じて、ACM の利用状況を監査できる。

これらのセキュリティ対策により、証明書とその鍵を安全に保護し、アプリケーションのセキュリティを確保する。

### 5. 料金形態

AWS Certificate Manager (ACM) は、パブリック SSL/TLS 証明書のプロビジョニング、管理、デプロイを、無料で利用できる。

ただし、AWS Private CA を利用してプライベート SSL/TLS 証明書を発行する場合は、AWS Private CA の利用料金が発生する。

### 6. よくあるアーキテクチャ・設計パターン

AWS Certificate Manager は、様々なセキュリティ要件に対応するために利用できる。一般的なパターンは以下の通りです:

- **Web サイトの HTTPS 化**: ロードバランサーや CloudFront と連携し、Web サイトを HTTPS で安全に提供。
- **API Gateway の HTTPS エンドポイント設定**: API Gateway のエンドポイントを HTTPS で保護。
- **ロードバランサーの HTTPS リスナー設定**: Elastic Load Balancer (ELB) の HTTPS リスナーを設定し、クライアントとの通信を暗号化。
- **CloudFront ディストリビューションの HTTPS 設定**: CloudFront ディストリビューションを HTTPS で提供し、コンテンツ配信を保護。
- **プライベート CA の運用**: AWS Private CA を利用し、企業内ネットワークで使用するプライベート証明書を発行。
- **コンテナアプリケーションの HTTPS 設定**: ECS や EKS で動作するコンテナアプリケーションに HTTPS 証明書を提供。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから AWS Certificate Manager を開き、証明書をリクエスト。
2. 証明書の検証方法（DNS 検証またはメール検証）を選択し、ドメインの所有権を検証。
3. ACM でプロビジョニングされた証明書を、ロードバランサー、CloudFront、API Gateway などのサービスにデプロイ。
4. 証明書のステータスを確認し、自動更新が有効であることを確認。

### 8. 試験で問われやすいポイント

#### 8.1 パブリック SSL/TLS 証明書

- **提供**: AWS のサービスで使用するパブリック SSL/TLS 証明書。
- **料金**: 無料でプロビジョニング、管理が可能。
- **試験対策**: パブリック証明書の利用方法、料金が問われる。

#### 8.2 プライベート SSL/TLS 証明書

- **連携**: AWS Private CA と連携。
- **利用**: プライベートネットワークで使用する証明書を発行。
- **試験対策**: プライベート証明書の利用方法、Private CA との連携が問われる。

#### 8.3 自動更新

- **機能**: パブリック証明書の更新を自動的に行う。
- **目的**: 証明書の有効期限切れによるサービスの停止を防ぐ。
- **試験対策**: 自動更新のメリット、設定方法が問われる。

#### 8.4 証明書のデプロイ

- **対象**: ロードバランサー、CloudFront、API Gateway など。
- **方法**: 数クリックで簡単にデプロイ可能。
- **試験対策**: 証明書のデプロイ先サービス、方法が問われる。

#### 8.5 検証方法

- **種類**: DNS 検証、メール検証。
- **利用**: ドメインの所有権を検証。
- **試験対策**: 各検証方法の特徴、利用シーンが問われる。

#### 8.6 料金体系

- **料金**: パブリック証明書は無料。
- **関連料金**: Private CA を利用する場合は、Private CA の利用料金が発生。
- **試験対策**: 料金体系、Private CA の料金が問われる。

#### 8.7 類似・関連サービスとの比較

- **AWS IAM**: AWS リソースへのアクセス制御サービス。ACM は証明書管理に特化。
- **AWS Private CA**: プライベート証明書を発行するサービス。ACM は Private CA と連携可能。

#### 8.8 試験で頻出となる具体的な問われ方と答え

- Q: AWS Certificate Manager (ACM) は何を提供するサービスですか？
  - A: AWS のサービスおよびプライベートネットワークで使用する SSL/TLS 証明書のプロビジョニング、管理、デプロイを容易にするサービスである。
- Q: AWS Certificate Manager でプロビジョニングできる SSL/TLS 証明書には、どのような種類があるか？
  - A: パブリック SSL/TLS 証明書とプライベート SSL/TLS 証明書の 2 種類がある。
- Q: AWS Certificate Manager は、どのようにパブリック SSL/TLS 証明書を更新するか？
  - A: 証明書の更新を自動的に行います。
- Q: AWS Certificate Manager で証明書をデプロイできる AWS サービスは何ですか？
  - A: ロードバランサー、CloudFront ディストリビューション、API Gateway などのサービスにデプロイできる。
- Q: AWS Certificate Manager の料金体系は？
  - A: パブリック SSL/TLS 証明書のプロビジョニング、管理、デプロイは無料で利用できる。

---

## AWS CloudHSM

### 1. サービス概要

AWS CloudHSM は、ハードウェアセキュリティモジュール(HSM)を AWS 上で専用に利用できるようにした、クラウドベースのハードウェア暗号化サービスである。  
従来のオンプレミスでの HSM 運用に近い形で鍵を管理・保持できるため、高いセキュリティ要件や規制準拠（PCI DSS、FIPS 140-2 レベル 3 など）に対応する用途に活用される。

主なユースケースとしては、

- 金融や保険
- 公共機関などの厳格な規制下にある機関での鍵管理
- 大規模な暗号処理（証明書発行、鍵生成、TLS/SSL セッションの終端処理など）

がある。  
ユーザーが鍵を完全に所有し、AWS 側でも読み出しできない点が特徴である。

### 2. 主な特徴と機能

#### 2.1 専用ハードウェアによる強固な鍵管理

CloudHSM は AWS が提供する物理的な HSM アプライアンスをユーザー専用に割り当てます。  
これにより、共用基盤ではなく専有環境で鍵を保持できるため、シングルテナントかつ高いセキュリティ隔離を実現する。

- **完全な鍵管理**: HSM 内の鍵はユーザーのみが制御し、AWS はアクセス不可
- **高速暗号処理**: 専用ハードウェアが暗号演算を高速かつ安全に実行

#### 2.2 FIPS 140-2 準拠

CloudHSM は FIPS 140-2 レベル 3 に準拠しており、高度な暗号鍵管理やハードウェアセキュリティを要する業界向けの要件を満たする。  
カード決済業界の PCI DSS 要件など、厳格なコンプライアンスにも対応可能である。

#### 2.3 スケーラビリティと可用性

必要に応じてクラスタを構成し、複数の CloudHSM インスタンスを展開することで、高可用性と負荷分散を実現できる。  
フェイルオーバー時にも鍵が失われないように自動レプリケーションされ、ダウンタイムの短縮に貢献する。

#### 2.4 柔軟な API サポート

PKCS#11 や JCE(Java Cryptography Extensions)、OpenSSL エンジンなど、業界標準の暗号 API をサポートしており、既存のアプリケーションとの統合が容易である。  
これによりオンプレミスからクラウドへの移行時や、カスタム暗号ロジックの実装がスムーズに行える。

#### 2.5 AWS Key Management Service(AWS KMS)との比較

CloudHSM はユーザーが鍵を完全に制御する一方、KMS は AWS によるフルマネージドでの鍵管理が可能である。  
クラウドネイティブな運用性を求めるなら KMS、より厳格な鍵所有を求めるなら CloudHSM、と使い分けるケースが一般的である。

### 3. アーキテクチャおよび技術要素

1. CloudHSM クラスタを作成し、VPC のサブネットに専用 HSM アプライアンスを配置
2. アプリケーションサーバは PKCS#11 等の暗号 API を介し、HSM で鍵生成・暗号化・復号化を実行
3. 鍵や証明書は HSM 内部に安全に保管され、AWS 側からはアクセス不可
4. クラスタによって複数の HSM 間で自動的に鍵がレプリケートされ、高可用性を確保

クライアントソフトウェア(AWS CloudHSM Client)を利用することで、アプリケーションはクラウド上の HSM をローカルの HSM と同様に扱えます。

### 4. セキュリティと認証・認可

CloudHSM はハードウェアレベルでのセキュリティ保護を提供する:

- **ハードウェア要塞化**: 物理的に改ざんされると自動的に鍵を破棄する仕組み
- **アクセスコントロール**: CloudHSM 内の鍵操作はユーザーが作成するトークン認証(PKCS#11 の PIN など)を利用
- **ネットワーク分離**: VPC 内のプライベートサブネットに配置し、許可された EC2 やオンプレミス環境からのみアクセスを許可

### 5. 料金形態

AWS CloudHSM の料金は、主に以下の要素に基づきます:

- **HSM インスタンスの時間単位料金**: 稼働している HSM アプライアンス 1 台あたりの時間単位の従量課金
- **クラスタ台数**: 高可用性確保のために複数台を起動する場合、台数に応じた料金が加算
- **データ転送料金**: 通常は VPC 内通信のためコストは低いが、プライベート接続形態などで追加費用が発生する場合もあり

### 6. よくあるアーキテクチャ・設計パターン

CloudHSM を導入する代表的なパターンは以下の通りです:

- **PCI DSS 準拠環境**: クレジットカード情報の暗号化やトランザクション処理をクラウドで安全に行う
- **SSL/TLS 終端**: Web サーバの SSL 証明書を CloudHSM 内に格納し、高速な TLS ハンドシェイクを実行
- **証明書発行基盤(CA)の構築**: ルート証明書を HSM 内で厳格に管理し、PKI 基盤のセキュリティを高める
- **KMS 連携**: CloudHSM で生成したカスタマー管理キー(CMK)を KMS にインポートし、用途によって使い分け

### 7. 設定・デプロイ手順（ハンズオン例）

1. VPC とサブネットを準備し、プライベートサブネット内に CloudHSM クラスタを作成
2. CloudHSM クライアントソフトウェアを EC2 インスタンスにインストール
3. クラスタへ接続し、鍵生成やユーザーアカウント設定を行う
4. アプリケーション側は PKCS#11/JCE/OpenSSL 等の API を通じて HSM での暗号操作を実行
5. 複数台のクラスタ構成により高可用性を確認

### 8. 試験で問われやすいポイント

#### 8.1 KMS との違い

- **CloudHSM**: ユーザーが鍵をフル制御。専用ハードウェアで FIPS 140-2 レベル 3 に準拠
- **KMS**: マルチテナントかつフルマネージド。AWS サービスとの統合が容易
- **使い分け**: 厳格な鍵所有が必要 →CloudHSM、クラウドネイティブ運用 →KMS

#### 8.2 セキュリティとコンプライアンス

- **FIPS 140-2**: レベル 3 に適合し、物理的改ざん対策に優れる
- **PCI DSS**: カード情報保護要件などの厳格な規制に対応
- **鍵所有モデル**: AWS が鍵にアクセスできず、ユーザーのみが制御

#### 8.3 アーキテクチャ設計

- **クラスタ構成**: 複数の HSM を配置して高可用性とフォールトトレランスを確保
- **VPC プライベートサブネット**: ネットワーク的にも隔離してリスクを最小化
- **API 互換性**: PKCS#11、JCE、OpenSSL など既存アプリとのインテグレーションが容易

#### 8.4 運用管理と可用性

- **メンテナンス**: AWS がハードウェアを管理し、利用者は論理的な鍵管理に集中
- **自動フェイルオーバー**: クラスタが故障しても鍵レプリケーションにより継続運用
- **監視ツール**: CloudWatch などで HSM インスタンスの状態や CPU 負荷を把握

#### 8.5 料金最適化

- **必要な台数のみ**: 本番/ステージング環境それぞれの最小限の HSM クラスタ数を設定
- **稼働時間の制御**: テスト環境で不要時は HSM を停止し、コストを抑える
- **通信コスト**: 主に VPC 内通信のため低コストだが、オンプレミス接続の場合は設計を最適化

#### 8.6 試験で頻出となる具体的な問われ方と答え

- Q: AWS KMS と CloudHSM の違いは？
  - A: 鍵管理の方法や責任分界。CloudHSM はユーザー専用 HSM で鍵を完全所有、KMS は AWS マネージド。
- Q: FIPS 140-2 レベル 3 のメリットは？
  - A: 物理的改ざんに対する耐性と厳格な暗号モジュール認証で、高いコンプライアンス要件を満たせる。
- Q: PKCS#11 を使う理由は？
  - A: 多くの暗号アプリケーションとの互換性が高く、既存システムとの統合が容易になるため。
- Q: CloudHSM の運用で気をつける点は？
  - A: HSM クラスタの可用性確保、VPC 内のネットワーク設計、鍵のバックアップ方針など。
- Q: クラスタを構成するメリットは？
  - A: フェイルオーバーによるダウンタイムの回避、暗号処理負荷の分散、高可用性の実現。

---

## AWS Directory Service

### 1. サービス概要

AWS Directory Service は、AWS クラウド環境で、Microsoft Active Directory (AD) やその他のディレクトリサービスを簡単に利用できるようにするサービスである。  
ユーザーは、既存の AD 環境を AWS クラウドに拡張したり、AWS Managed Microsoft AD のようなフルマネージドの AD を新たに作成したりできる。  
これにより、ユーザー認証、アクセス制御、グループポリシーなどを集中管理し、AWS 環境とオンプレミス環境の連携を容易にできる。

主なユースケースとして、

- EC2 インスタンスのドメイン参加
- WorkSpaces のユーザー管理
- Amazon RDS for SQL Server の認証
- Windows ベースアプリケーションの認証・認可
- SharePoint などのエンタープライズアプリケーションの利用

などが挙げられます。  
AWS Directory Service は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 AWS Managed Microsoft AD

AWS が管理するフルマネージドの Microsoft Active Directory を提供する。  
ユーザーは、AD インフラの構築や管理を行うことなく、AD の機能を利用できる。

#### 2.2 AD Connector

既存のオンプレミス AD と AWS 環境を接続するためのプロキシとして機能する。  
ユーザーは、オンプレミスの AD 認証情報を利用して、AWS リソースにアクセスできる。

#### 2.3 Simple AD

AWS クラウド環境で、シンプルなスタンドアロンの AD を提供する。  
ユーザーは、小規模な環境や開発環境で、AD 機能を簡単に利用できる。

#### 2.4 AD 対応アプリケーションの利用

AD に対応した様々な AWS サービス（例：WorkSpaces, Amazon RDS for SQL Server など）やアプリケーションを、AD 環境で利用できる。  
これにより、既存の AD 環境を AWS クラウドに拡張し、エンタープライズアプリケーションを容易に利用できる。

#### 2.5 信頼関係

AWS Managed Microsoft AD とオンプレミス AD との間に、双方向の信頼関係を設定できる。  
これにより、オンプレミスと AWS の両方のリソースに、同じ認証情報でアクセスできる。

#### 2.6 グループポリシー

グループポリシーを利用して、ユーザーやコンピューターの設定を集中管理できる。  
これにより、AWS 環境全体で一貫した設定を適用できる。

#### 2.7 統合性と拡張性

AWS Directory Service は、Amazon EC2, Amazon RDS, Amazon WorkSpaces, AWS IAM などの AWS の他のサービスと密接に統合されています。  
また、API を利用して、ディレクトリサービスの管理を自動化することもできる。

### 3. アーキテクチャおよび技術要素

1. ユーザーは、AWS Directory Service で AWS Managed Microsoft AD、AD Connector、または Simple AD を作成。
2. EC2 インスタンス、WorkSpaces、RDS などの AWS リソースは、ディレクトリサービスに参加。
3. ユーザーは、ディレクトリサービスで認証を行い、AWS リソースにアクセス。
4. 必要に応じて、オンプレミス AD と AWS Managed Microsoft AD の間で信頼関係を確立。

AWS Directory Service は、AWS のインフラ上に構築されており、高い可用性と信頼性を提供する。  
ディレクトリサービスのプロビジョニングや管理は AWS が行うため、ユーザーはインフラの管理を行う必要はありません。

#### 4. セキュリティと認証・認可

AWS Directory Service は、ディレクトリサービスのセキュリティを確保するために、以下の機能を提供する:

- **IAM 統合**: AWS Identity and Access Management (IAM) を利用して、AWS Directory Service へのアクセスを制御する。
- **VPC 内での実行**: ディレクトリサービスは Virtual Private Cloud (VPC) 内で実行され、ネットワーク隔離を実現。
- **データ暗号化**: データは転送中および保存時に暗号化される。
- **アクセス制御**: IAM ポリシーを通じて、ユーザーやグループごとに、AWS Directory Service の操作権限を詳細に制御できる。
- **監査ログ**: CloudTrail を通じて、AWS Directory Service の利用状況を監査できる。

これらのセキュリティ対策により、ディレクトリサービスとそのデータを安全に保護する。

### 5. 料金形態

AWS Directory Service の料金は主に以下に基づきます:

- **AWS Managed Microsoft AD**: 1 か月あたりに利用した時間に応じた料金と、ストレージ容量に応じた料金。
- **AD Connector**: 接続数に応じた料金。
- **Simple AD**: 1 か月あたりに利用した時間に応じた料金と、ストレージ容量に応じた料金。

### 6. よくあるアーキテクチャ・設計パターン

AWS Directory Service は、様々な AWS 環境で利用できる。  
一般的なパターンは以下の通りです:

- **EC2 インスタンスのドメイン参加**: EC2 インスタンスを AWS Managed Microsoft AD に参加させ、AD 認証を利用。
- **WorkSpaces のユーザー管理**: AWS WorkSpaces のユーザー管理に、AWS Managed Microsoft AD を利用。
- **Amazon RDS for SQL Server の認証**: Amazon RDS for SQL Server の認証に、AWS Managed Microsoft AD を利用。
- **Windows ベースアプリケーションの認証・認可**: Windows ベースのアプリケーションの認証・認可を AD 環境で行う。
- **SharePoint などのエンタープライズアプリケーションの利用**: SharePoint などのエンタープライズアプリケーションを AWS 環境で利用する際に、AD 環境を連携。
- **ハイブリッド環境での認証連携**: オンプレミス AD と AWS Managed Microsoft AD を連携し、ハイブリッド環境全体で認証を統合。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから AWS Directory Service を開き、AWS Managed Microsoft AD、AD Connector、または Simple AD を作成。
2. VPC、サブネット、セキュリティグループなどのネットワーク設定を構成。
3. EC2 インスタンス、WorkSpaces などの AWS リソースをディレクトリサービスに参加。
4. 必要に応じて、オンプレミス AD との信頼関係を設定。
5. AD ユーザーを作成し、AWS リソースへのアクセス権限を付与。
6. AD 認証でリソースにアクセス。

### 8. 試験で問われやすいポイント

#### 8.1 AWS Managed Microsoft AD

- **特徴**: AWS が管理するフルマネージドの AD。
- **利点**: AD インフラの管理が不要。
- **試験対策**: フルマネージド AD の利点、利用ケースが問われる。

#### 8.2 AD Connector

- **機能**: オンプレミス AD と AWS 環境を接続するプロキシ。
- **利用**: オンプレミス AD 認証情報を利用して AWS リソースにアクセス。
- **試験対策**: AD Connector の役割、利用ケースが問われる。

#### 8.3 Simple AD

- **特徴**: AWS クラウド環境でシンプルなスタンドアロン AD を提供。
- **利用**: 小規模な環境や開発環境での AD 利用。
- **試験対策**: Simple AD の利用ケース、Managed AD との違いが問われる。

#### 8.4 AD 対応アプリケーションの利用

- **対象**: WorkSpaces、RDS for SQL Server など。
- **目的**: 既存の AD 環境を AWS クラウドに拡張。
- **試験対策**: AD 対応アプリケーションの例、利用方法が問われる。

#### 8.5 信頼関係

- **対象**: AWS Managed Microsoft AD とオンプレミス AD。
- **機能**: 双方向の信頼関係を設定。
- **試験対策**: 信頼関係のメリット、設定方法が問われる。

#### 8.6 グループポリシー

- **機能**: ユーザーやコンピューターの設定を集中管理。
- **利用**: AWS 環境全体で一貫した設定を適用。
- **試験対策**: グループポリシーの利用目的、メリットが問われる。

#### 8.7 料金体系

- **課金対象**: AWS Managed Microsoft AD、AD Connector、Simple AD の利用時間、ストレージ容量。
- **最適化**: 不要なリソースを削減し、利用時間を最適化。
- **試験対策**: 各サービスの料金体系、課金要素が問われる。

#### 8.8 類似・関連サービスとの比較

- **AWS IAM**: AWS リソースへのアクセス制御に特化。Directory Service はユーザー認証とディレクトリサービスを提供。
- **AWS Single Sign-On (SSO)**: 複数の AWS アカウントやアプリケーションへのシングルサインオンを提供。Directory Service は認証基盤として利用される。

#### 8.9 試験で頻出となる具体的な問われ方と答え

- Q: AWS Directory Service は何を提供するサービスですか？
  - A: AWS クラウド環境で、Microsoft Active Directory (AD) やその他のディレクトリサービスを簡単に利用できるようにするサービスである。
- Q: AWS Directory Service には、どのような種類のディレクトリサービスがあるか？
  - A: AWS Managed Microsoft AD、AD Connector、Simple AD の 3 つの種類がある。
- Q: AWS Managed Microsoft AD は、どのような特徴を持っていますか？
  - A: AWS が管理するフルマネージドの Microsoft Active Directory を提供する。
- Q: AWS Directory Service の AD Connector は、どのような役割を果たするか？
  - A: 既存のオンプレミス AD と AWS 環境を接続するためのプロキシとして機能する。
- Q: AWS Directory Service の料金はどのように計算されるか？
  - A: AWS Managed Microsoft AD、AD Connector、Simple AD の利用時間、ストレージ容量などに基づいて計算される。

---

## AWS Firewall Manager

### 1. サービス概要

AWS Firewall Manager は、AWS WAF や AWS Shield などのセキュリティルールを一元管理し、複数の AWS アカウントやアプリケーションにわたってセキュリティポリシーを適用・保守するためのマネージドサービスである。  
これにより、全アカウント・複数リージョンにおけるファイアウォール設定の整合性を保ち、脅威からの保護を統一的に運用できる。

主なユースケースとして、

- AWS Organizations を活用したマルチアカウント環境でのセキュリティポリシー統制
- Web アプリケーションへの不正アクセス対策の一元化
- 急増する DDoS 攻撃への包括的対応

などが挙げられます。

### 2. 主な特徴と機能

#### 2.1 一元管理によるポリシー適用

Firewall Manager を使用すると、AWS WAF で定義したルールや、AWS Shield Advanced を有効化する設定を中心化して管理できる。  
組織全体で共通のセキュリティポリシーを簡単に適用することで、設定のばらつきや誤ったルール構成を防止する。

- **ポリシー自動適用**: 新規に作成されたリソース（ALB、CloudFront など）にも自動的に WAF/Shield ルールを適用
- **ドリフト防止**: 手動の変更でルール構成が壊れるのを防ぎ、監査性を確保

#### 2.2 AWS Organizations 連携

Firewall Manager は AWS Organizations における管理アカウント(Management Account)を通じて、メンバーアカウントのリソース全体をカバーする。  
数十〜数百といった大規模なマルチアカウント環境でも、集中管理によりコストと運用負荷を大幅に削減できる。

#### 2.3 AWS Shield Advanced サポート

Firewall Manager は、有料版の DDoS 対策サービスである AWS Shield Advanced とも統合されています。  
例えば特定のロードバランサや CloudFront ディストリビューションを Shield Advanced で保護対象とするポリシーを一括設定し、DDoS 対策の抜け漏れを最小化できる。

#### 2.4 セキュリティポリシーの包括的制御

Firewall Manager は AWS WAF ルールの他にも、複数サービスのセキュリティ設定を一括管理できる。  
これにより、異なるプロジェクトやアカウントのリソースに対しても、共通ルールを迅速に展開できる。

### 3. アーキテクチャおよび技術要素

1. AWS Organizations でマルチアカウント構成を管理し、Firewall Manager の管理者(Administrator)アカウントを指定
2. Firewall Manager でポリシー(WAF ルール、Shield Advanced 適用など)を定義
3. 組織内のメンバーアカウントが作成・保有するリソース(CloudFront, ALB, API Gateway 等)に対して、自動的にポリシーが適用
4. ポリシー違反がある場合、警告やレポートを表示して修正を促す

Firewall Manager は AWS WAF、Shield Advanced、VPC Security Group などの設定と連携し、ユーザーは管理対象を選択するだけで一括制御を実現する。

### 4. セキュリティと認証・認可

Firewall Manager の利用にあたっては、次のようなセキュリティ面が重要である:

- **IAM ロール**: Firewall Manager がメンバーアカウントのリソース情報や WAF ルールを変更するために必要な権限を付与
- **Organizations 管理**: AWS Organizations の Administrator/Member アカウントの設定に基づき、ポリシーを強制適用
- **暗号化・監査ログ**: Firewall Manager 自体がカスタマイズ可能なアクセスログは持たないが、AWS WAF ログや CloudTrail を利用し運用状況を監査

### 5. 料金形態

AWS Firewall Manager の料金は以下の要素で構成される:

- **Firewall Manager 月額**: アクティブなポリシー数に基づく月額料金（AWS 公式ページを参照）
- **AWS WAF/Shield Advanced 利用料**: Firewall Manager とは別に、利用する WAF ルール数や Shield Advanced 料金が発生
- **その他**: VPC セキュリティグループ管理ポリシーを利用する場合は追加コストが発生する場合あり

### 6. よくあるアーキテクチャ・設計パターン

Firewall Manager の導入で典型的なパターンには以下がある:

- **Web アプリ防御の標準化**: 全アカウントの ALB や CloudFront に対して共通の WAF ルールセットを適用
- **DDoS プロテクション統合**: AWS Shield Advanced を組織全体に導入し、DDoS 対策を一元管理
- **VPC セキュリティグループの標準化**: 不要に広いポート・IP レンジを利用していないか、組織規模で監視・強制修正
- **自動ポリシー適用**: 新たに作成されたロードバランサや CloudFront ディストリビューションに自動で WAF ルールを追加

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS Organizations を準備し、管理アカウント(Management Account)を特定
2. Firewall Manager コンソールへ移動し、「Administrator Account」として使用するアカウントを設定
3. ポリシーを新規作成 (例: WAF ポリシー、Shield Advanced ポリシー、セキュリティグループポリシー)
4. 対象となるリソースタイプ(CloudFront, ALB, etc.)とスコープ（含める/除外するアカウントやリソース）を指定
5. 正常にポリシーが適用されているか、違反が検知された場合はレポート内容を確認

### 8. 試験で問われやすいポイント

#### 8.1 AWS WAF との連携

- **Firewall Manager の役割**: WAF ルールそのものを作成・編集するのではなく、一元適用・管理が主眼
- **ルールセットの適用**: CloudFront や ALB といった複数エンドポイントに同一ルールを自動適用
- **カスタムルールとマネージドルール**: OWASP Top 10 等のマネージドルールを使って手軽にパターン防御を導入

#### 8.2 AWS Shield Advanced との連携

- **有効化ポリシー**: 指定リソースをまとめて Shield Advanced 保護対象にする
- **DDoS 攻撃時のメリット**: 緊急対応サポートや攻撃コスト保護などの Shield Advanced 特典が全リソースに行き渡る
- **コスト考慮**: Shield Advanced は有料のため、対象リソースを明確に絞る

#### 8.3 マルチアカウント管理

- **Organizations 統合**: Firewall Manager 管理アカウントを介してメンバーアカウントへのポリシーを強制
- **スコープ設定**: すべてのアカウントを対象にするか、一部だけに適用するか柔軟に調整可能
- **ポリシー違反の可視化**: メンバーアカウント側で誤設定した場合でも、一元的に検知・修正

#### 8.4 運用管理と通知

- **EventBridge 連携**: ポリシー違反や新規リソース検出をイベントトリガーとして SNS や Lambda で通知・自動修復
- **コンソールモニタリング**: Firewall Manager ダッシュボードで組織全体のセキュリティポリシー状況を一望
- **ログ連携**: ルール適用状況は CloudTrail や AWS WAF ログで追跡

#### 8.5 料金最適化

- **ポリシー数の制御**: 不要なポリシーを増やさないように設計し、Firewall Manager のコストを抑える
- **Shield Advanced 対象最適化**: すべてのリソースを保護対象にするのではなく、本当に重要なエンドポイントのみ適用
- **WAF ルール最適化**: 過剰なカスタムルールや多数のマネージドルールを無闇に適用しない

#### 8.6 試験で頻出となる具体的な問われ方と答え

- Q: Firewall Manager で管理できる主なサービスは？
  - A: AWS WAF、AWS Shield Advanced、VPC Security Groups。
- Q: Firewall Manager を利用するメリットは？
  - A: マルチアカウントに対して一元的にセキュリティルールを適用し、保守と運用を効率化。
- Q: Firewall Manager と AWS Organizations の関係は？
  - A: Firewall Manager で一元管理を行うには Organizations 連携が前提。管理アカウントでポリシーを作成し、メンバーアカウントに適用。
- Q: Shield Advanced を Firewall Manager で管理すると何が変わる？
  - A: 組織全体のリソースをまとめて DDoS 対策に含められ、攻撃時のサポートやコスト保護を一括享受できる。
- Q: 料金を抑えるコツは？
  - A: 必要最小限のポリシー設定、重要度に応じた Shield Advanced 適用範囲、WAF ルールの最適化。

---

## AWS Identity and Access Management (AWS IAM)

### 1. サービス概要

AWS Identity and Access Management (IAM) は、AWS リソースへのアクセスを安全に制御するためのサービスである。  
ユーザーは、IAM ユーザー、IAM グループ、IAM ロールなどの ID を作成し、それぞれに AWS リソースへのアクセス権限を付与できる。  
IAM は、AWS 環境におけるセキュリティの基本であり、最小権限の原則に基づいて、アクセス制御を行うことを推奨する。

主なユースケースとして、

- AWS アカウントへのアクセス制御
- EC2 インスタンスへのアクセス制御
- API Gateway へのアクセス制御
- Lambda 関数へのアクセス制御
- クロスアカウントアクセス

などが挙げられます。  
AWS IAM は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 IAM ユーザー

IAM ユーザーは、AWS へのアクセスに使用する個人またはアプリケーション用の ID である。  
IAM ユーザーには、パスワード、アクセスキーなどの認証情報を設定できる。

#### 2.2 IAM グループ

IAM グループは、複数の IAM ユーザーをまとめて管理するためのグループである。  
グループにポリシーを適用することで、複数のユーザーに同じ権限を簡単に付与できる。

#### 2.3 IAM ロール

IAM ロールは、AWS リソースに一時的なアクセス権限を付与するための ID である。  
EC2 インスタンス、Lambda 関数などの AWS リソースに IAM ロールを割り当てることで、リソースが他の AWS リソースに安全にアクセスできるようになります。

#### 2.4 IAM ポリシー

IAM ポリシーは、AWS リソースへのアクセス権限を定義するドキュメントである。  
IAM ポリシーは、IAM ユーザー、IAM グループ、IAM ロールにアタッチできる。  
ポリシーは、JSON 形式で記述され、許可または拒否するアクション、リソース、条件などを指定できる。

#### 2.5 多要素認証 (MFA)

IAM ユーザーに対して、多要素認証（MFA）を有効にできる。  
これにより、パスワードだけでなく、追加の認証要素を要求することで、セキュリティを強化できる。

#### 2.6 認証情報の管理

IAM は、アクセスキー、パスワード、MFA デバイスなどの認証情報を管理するための機能を提供する。  
ユーザーは、これらの認証情報を安全に管理し、AWS リソースへのアクセスを制御できる。

#### 2.7 統合性と拡張性

AWS IAM は、AWS の他のサービス（EC2、S3、RDS、Lambda など）と密接に統合されており、AWS 環境全体のリソースへのアクセス制御を一元的に管理できる。  
また、API を利用して、IAM の管理を自動化することもできる。

### 3. アーキテクチャおよび技術要素

1. ユーザーは、AWS マネジメントコンソールまたは API を通じて、IAM ユーザー、IAM グループ、IAM ロールなどの ID を作成。
2. IAM ポリシーを作成し、AWS リソースへのアクセス権限を定義。
3. IAM ポリシーを、IAM ユーザー、IAM グループ、IAM ロールにアタッチ。
4. AWS リソースへのアクセスリクエストは、IAM によって認証、認可。
5. リクエストされたリソースへのアクセスが許可されると、アクセス可能。

AWS IAM は、AWS のグローバルインフラストラクチャの一部であり、高い可用性とスケーラビリティを提供する。  
認証、認可などのアクセス制御は AWS が行うため、ユーザーはインフラの管理を行う必要はありません。

### 4. セキュリティと認証・認可

AWS IAM は、AWS 環境のセキュリティを確保するための基盤となるサービスです:

- **最小権限の原則**: 必要最小限の権限のみをユーザーやリソースに付与。
- **多要素認証 (MFA)**: パスワード認証に加えて、MFA を要求してセキュリティを強化。
- **パスワードポリシー**: 強力なパスワードを強制するためのパスワードポリシーを設定。
- **アクセスキーのローテーション**: 定期的にアクセスキーをローテーションして、セキュリティリスクを低減。
- **IAM ポリシーの管理**: IAM ポリシーを適切に管理し、アクセス権限を制御。

これらのセキュリティ対策により、AWS 環境への不正アクセスを防止し、機密情報を保護できる。

### 5. 料金形態

AWS Identity and Access Management (IAM) は、無料で利用できるサービスである。

ただし、IAM と連携する他の AWS サービス（EC2、S3、RDS など）の利用料金は発生する。

### 6. よくあるアーキテクチャ・設計パターン

AWS IAM は、様々なアクセス制御シナリオで利用できる。  
一般的なパターンは以下の通りです:

- **AWS アカウントへのアクセス制御**: AWS アカウントへのログイン認証とアクセス権限を IAM ユーザーで制御。
- **EC2 インスタンスへのアクセス制御**: EC2 インスタンスに IAM ロールを割り当て、他の AWS リソースへのアクセスを制御。
- **API Gateway へのアクセス制御**: API Gateway の API にアクセスするための認証と認可を IAM ポリシーで制御。
- **Lambda 関数へのアクセス制御**: Lambda 関数に IAM ロールを割り当て、他の AWS リソースへのアクセスを制御。
- **クロスアカウントアクセス**: 複数の AWS アカウント間でリソースにアクセスするための IAM ロールを設定。
- **S3 バケットへのアクセス制御**: S3 バケットへのアクセスを IAM ポリシーで制御。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから AWS IAM を開き、IAM ユーザーを作成。
2. IAM グループを作成し、ユーザーをグループに追加。
3. IAM ロールを作成し、EC2 インスタンスなどの AWS リソースにアタッチ。
4. IAM ポリシーを作成し、リソースへのアクセス権限を定義。
5. MFA を有効化し、セキュリティを強化。

### 8. 試験で問われやすいポイント

#### 8.1 IAM ユーザー

- **定義**: AWS へのアクセスに使用する個人またはアプリケーション用の ID。
- **特徴**: パスワード、アクセスキーなどの認証情報を設定。
- **試験対策**: IAM ユーザーの基本概念、利用方法が問われる。

#### 8.2 IAM グループ

- **定義**: 複数の IAM ユーザーをまとめて管理するためのグループ。
- **利用**: グループにポリシーを適用し、複数のユーザーに同じ権限を付与。
- **試験対策**: IAM グループの役割、利用ケースが問われる。

#### 8.3 IAM ロール

- **定義**: AWS リソースに一時的なアクセス権限を付与するための ID。
- **利用**: EC2 インスタンス、Lambda 関数などに割り当てる。
- **試験対策**: IAM ロールの利用方法、一時的な権限付与が問われる。

#### 8.4 IAM ポリシー

- **定義**: AWS リソースへのアクセス権限を定義するドキュメント。
- **形式**: JSON 形式で記述。
- **試験対策**: IAM ポリシーの記述方法、許可/拒否ルールが問われる。

#### 8.5 多要素認証 (MFA)

- **機能**: パスワードだけでなく、追加の認証要素を要求。
- **目的**: セキュリティを強化、不正アクセスを防止。
- **試験対策**: MFA の重要性、設定方法が問われる。

#### 8.6 料金体系

- **料金**: AWS IAM は無料で利用可能。
- **関連料金**: IAM と連携する AWS サービスの利用料金が発生。
- **試験対策**: 料金に関する正しい知識が問われる。

#### 8.7 類似・関連サービスとの比較

- **AWS Organizations**: 複数の AWS アカウントを組織として管理するサービス。IAM はアカウント内のアクセス制御に特化。
- **AWS Single Sign-On (SSO)**: 複数の AWS アカウントやアプリケーションへのシングルサインオンを提供。IAM は個々のユーザーやリソースのアクセス制御に特化。

#### 8.8 試験で頻出となる具体的な問われ方と答え

- Q: AWS Identity and Access Management (IAM) は何を提供するサービスですか？
  - A: AWS リソースへのアクセスを安全に制御するためのサービスである。
- Q: IAM ユーザーとは何ですか？
  - A: AWS へのアクセスに使用する個人またはアプリケーション用の ID である。
- Q: IAM ロールは何に使用するか？
  - A: AWS リソースに一時的なアクセス権限を付与するために使用する。
- Q: IAM ポリシーとは何ですか？
  - A: AWS リソースへのアクセス権限を定義するドキュメントである。
- Q: AWS IAM の料金は？
  - A: 無料で利用できる。

---

## AWS Key Management Service (AWS KMS)

### 1. サービス概要

AWS Key Management Service (AWS KMS)は、データの暗号化およびキー管理を安全かつ簡単に行うためのフルマネージドサービスである。  
暗号鍵の作成・保持・ローテーション・廃棄まで一貫して管理し、多くの AWS サービス（Amazon S3、Amazon EBS、AWS Lambda など）とネイティブに連携することで、安全な暗号化機能を提供する。

主なユースケースには、

- データ暗号化の規制・コンプライアンス対応
- 機密情報を含むログやバックアップの保護
- アプリケーションレベルでの機密データ保護

などが挙げられます。

### 2. 主な特徴と機能

#### 2.1 フルマネージド型の暗号鍵管理

KMS は暗号鍵（Customer Master Key, CMK）のライフサイクルを AWS が管理・運用し、耐障害性や冗長化も自動で担保する。  
ユーザーはキーポリシーを設定するだけで、煩雑なハードウェア保守やソフトウェアパッチ適用から解放される。

- **CMK の作成・削除**: 数クリックで鍵を作成し、不要になれば安全に削除
- **自動ローテーション**: 任意の期間（例: 1 年）で CMK を自動ローテーション可

#### 2.2 多様な暗号化モードをサポート

AWS KMS では、用途に応じて主に以下の暗号化モードを提供している:

- **SSE-KMS**: S3 や EBS など AWS サービスと連携し、サーバサイド暗号化を KMS 管理の鍵で実行
- **Client-Side Encryption**: SDK などを用いてクライアント側でデータを暗号化し、その鍵を KMS で保護
- **Data Keys**: KMS がデータ暗号化用の一時鍵（データキー）を生成し、アプリケーションレイヤーでの暗号化を実現

#### 2.3 AWS サービスとのシームレスな統合

S3、EBS、RDS、Secrets Manager など、多くの AWS サービスが KMS を暗号化エンジンとして利用可能である。  
これにより、暗号化のコード実装を最小限に抑えながら、一貫したセキュリティポリシーを組織全体で適用できる。

#### 2.4 キーポリシーとアクセス制御

KMS では「キーポリシー」を通じて詳細なアクセス権限を設定できる。  
これにより、特定の IAM ユーザーやロールにだけ鍵操作を許可し、暗号化/復号化の範囲を厳密に制御できる。  
また、グラント(Grant)機能で一時的なアクセス権限を付与することも可能である。

#### 2.5 CloudHSM 統合(カスタマー管理キーストア)

必要に応じて、CloudHSM を使った Custom Key Store 機能も利用可能である。  
これにより、専用 HSM で管理する鍵を KMS から呼び出す構成が組めます。  
FIPS 140-2 など厳格なコンプライアンス要件を満たす環境での鍵管理に適している。

### 3. アーキテクチャおよび技術要素

1. CMK を作成し、キーポリシーでアクセス可能なプリンシパル(IAM ユーザー/ロール)を指定
2. アプリケーションや AWS サービスが KMS に暗号化または復号化リクエストを行う
3. KMS はリクエストの署名や権限を検証し、問題がなければ鍵操作を実行
4. KMS はデータキーの生成や暗号化を行い、クライアントは実際のデータ暗号化処理を実施
5. KMS へのすべてのリクエストは AWS CloudTrail で監査ログが残されるため、セキュリティとトレーサビリティが高まります。

### 4. セキュリティと認証・認可

AWS KMS を利用する際、特に以下のセキュリティ面が重要である:

- **キーポリシーの最小権限**: CMK に対する暗号化/復号化権限を必要最小限に絞る
- **IAM との連携**: キーポリシーと IAM ポリシーを組み合わせて、厳密なアクセス制御を実現
- **ログ監査**: CloudTrail に記録される KMS API 呼び出しログを定期的に分析
- **Custom Key Store(CloudHSM)**: さらに高い管理要件を必要とする場合に専用 HSM でのキーストアを利用

### 5. 料金形態

AWS KMS の料金は以下の要素で構成される:

- **キー管理**: CMK（カスタマーマネージドキー）の作成数やキー保管料は地域や使用量に応じて変動
- **API リクエスト**: 暗号化や復号化、キー生成リクエストなど 1 リクエストあたり従量課金
- **カスタマー管理キーストア(CloudHSM)利用時**: CloudHSM の使用料金が別途発生

### 6. よくあるアーキテクチャ・設計パターン

KMS を活用する代表的なパターンは以下の通りです:

- **S3・EBS などの暗号化**: SSE-KMS を適用してデータストレージを自動暗号化
- **Secrets Manager や Parameter Store**: これらが保管するパスワードや API キーを KMS で保護
- **アプリケーションレイヤー暗号化**: Data Key を取得してクライアントサイドで独自暗号化を実行
- **カスタムキー管理ストア**: オンプレミスに準拠した鍵管理を必要とする場合、CloudHSM を併用

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS コンソールで「Key Management Service (KMS)」を検索し、サービスを開く
2. 「Customer managed keys」から「Create key」を選択し、鍵タイプ(対称/非対称)と用途を指定
3. キーポリシーで暗号化/復号化できる IAM ユーザー・ロールを設定
4. 例えば S3 バケットを開き、デフォルトの暗号化を「AWS KMS – カスタマーマネージドキー」に変更
5. ファイルをアップロードし、暗号化が KMS キーで行われていることを確認

### 8. 試験で問われやすいポイント

#### 8.1 CMK の種類

- **AWS マネージドキー**: AWS サービス専用に自動作成されたキー
- **カスタマーマネージドキー**: ユーザーが自分で作成し、キーポリシーを設定可能
- **AWS オーナーキー**: AWS がオーナーとなるキーで、ユーザーが直接管理はしない

#### 8.2 キーポリシーと IAM ポリシーの違い

- **キーポリシー**: どのアカウント・ユーザーが鍵を操作できるか定義
- **IAM ポリシー**: ユーザーやロールに割り当てるアクセス権限を定義
- **両者の組み合わせ**: キーポリシーと IAM ポリシーの両方で許可されている場合に鍵操作が可能

#### 8.3 SSE-KMS vs. SSE-S3

- **SSE-KMS**: マスターキーを KMS が管理、アクセス制御や監査ログが詳細
- **SSE-S3**: S3 が自動的に暗号化・復号化、KMS より柔軟性は低いが運用が簡易
- **使い分け**: きめ細かい権限管理や監査が必要なら SSE-KMS、シンプルな暗号化なら SSE-S3

#### 8.4 CloudHSM 連携

- **カスタマー管理キーストア**: KMS が CloudHSM クラスタと連携し、ユーザー専用 HSM で鍵を保持
- **メリット**: FIPS 140-2 レベル 3 などの厳格な規制対応をクリア
- **代償**: CloudHSM 利用料金や追加の運用管理が発生

#### 8.5 リクエストとコスト

- **暗号化リクエスト**: 1 リクエストあたり数円程度で従量課金
- **キー保管料**: 地域やキー数により変動
- **削除スケジューリング**: CMK はすぐ削除できず、デフォルト 7 ～ 30 日間の保留期間

#### 8.6 試験で頻出となる具体的な問われ方と答え

- Q: AWS KMS を使用するメリットは？
  - A: 暗号鍵のライフサイクルをフルマネージドし、AWS 各サービスとシームレスに連携できる。
- Q: SSE-KMS と SSE-S3 の違いは？
  - A: SSE-KMS では KMS のマスターキーを利用し詳細なアクセス制御・監査が可能、SSE-S3 は S3 が内部的に鍵を管理。
- Q: キーポリシーと IAM ポリシーのどちらで権限を設定する？
  - A: 両方。キーポリシーで鍵へのアクセス範囲を定義し、IAM ポリシーでユーザー/ロールの権限を付与する。
- Q: カスタマー管理キーストアを利用する理由は？
  - A: CloudHSM 連携により、ユーザー専用 HSM で厳格に鍵を管理し、コンプライアンス要件を満たすため。
- Q: CMK をすぐに削除できないのはなぜ？
  - A: 誤削除によるデータ復号不可を防ぐため、7 ～ 30 日間の保留期間が必要。

---

## AWS Network Firewall

### 1. サービス概要

AWS Network Firewall は、AWS 環境でネットワークトラフィックを保護するための、フルマネージドでスケーラブルなネットワークファイアウォールサービスである。  
ユーザーは、VPC（Virtual Private Cloud）内のトラフィックを詳細に制御し、不正なアクセスや悪意のあるトラフィックをブロックできる。  
Network Firewall は、高度な脅威対策、柔軟なルール設定、AWS 環境との統合を提供し、セキュリティ体制を強化する。

主なユースケースとして、

- VPC 境界の保護
- インターネットからの悪意のあるトラフィックのブロック
- VPC 間のトラフィック制御
- コンプライアンス要件の遵守
- カスタム脅威インテリジェンスの利用

などが挙げられます。  
AWS Network Firewall は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 ステートフルファイアウォール

Network Firewall は、ステートフルなパケット検査を行い、トラフィックを詳細に制御できる。  
これにより、コネクションの状態を追跡し、双方向の通信を許可または拒否できる。

#### 2.2 柔軟なルール設定

Suricata 互換のルールエンジンを使用し、カスタムルールを定義できる。  
ユーザーは、IP アドレス、ポート、プロトコルなどの様々な条件に基づいてルールを作成し、ネットワークトラフィックを詳細に制御できる。

#### 2.3 侵入防止システム (IPS)

悪意のあるネットワークトラフィックを検出し、自動的にブロックできる。  
これにより、既知の攻撃パターンや脆弱性を悪用した攻撃からネットワークを保護できる。

#### 2.4 可視性

ファイアウォールのログを CloudWatch Logs に送信し、ネットワークトラフィックを監視できる。  
これにより、ネットワークアクティビティの可視性を高め、セキュリティインシデントの分析を容易にできる。

#### 2.5 AWS 環境との統合

Network Firewall は、VPC, Route 53 Resolver, AWS Firewall Manager などの AWS の他のサービスと密接に統合されており、AWS 環境全体のセキュリティを強化できる。

#### 2.6 スケーラビリティ

Network Firewall は、AWS のインフラ上で動作し、トラフィックの増加に応じて自動的にスケールする。  
これにより、トラフィックの変動に対応し、安定したネットワークパフォーマンスを維持できる。

#### 2.7 フルマネージドサービス

Network Firewall は、フルマネージドサービスであり、ハードウェアの管理やソフトウェアの更新は AWS が行います。  
ユーザーは、インフラストラクチャの管理を行う必要はなく、セキュリティポリシーの設定に集中できる。

### 3. アーキテクチャおよび技術要素

1. ユーザーは、Network Firewall エンドポイントを VPC 内に作成。
2. Network Firewall は、VPC 内のトラフィックを検査し、設定されたルールに基づいてトラフィックを許可または拒否。
3. 必要に応じて、トラフィックを他のセキュリティデバイスやサービスへルーティング。
4. Network Firewall は、ログを CloudWatch Logs に送信。
5. AWS Firewall Manager と連携し、組織全体のファイアウォールポリシーを一元的に管理。

AWS Network Firewall は、AWS のインフラ上に構築されており、高い可用性とスケーラビリティを提供する。  
ファイアウォールの管理は AWS が行うため、ユーザーはインフラの管理を行う必要はありません。

### 4. セキュリティと認証・認可

AWS Network Firewall は、ネットワークトラフィックを安全に保護するために、以下の機能を提供する:

- **IAM 統合**: AWS Identity and Access Management (IAM) を利用して、Network Firewall へのアクセスを制御する。
- **VPC 内での実行**: Network Firewall は Virtual Private Cloud (VPC) 内で実行され、ネットワーク隔離を実現。
- **データ暗号化**: Network Firewall のログデータや設定データは暗号化される。
- **アクセス制御**: IAM ポリシーを通じて、ユーザーやグループごとに、Network Firewall の操作権限を詳細に制御できる。
- **ステートフルインスペクション**: ネットワークトラフィックを双方向に検査し、セキュリティを確保。

これらのセキュリティ対策により、VPC 内のネットワークトラフィックを安全に保護し、不正アクセスや攻撃から保護する。

### 5. 料金形態

AWS Network Firewall の料金は主に以下に基づきます:

- **ファイアウォールエンドポイント**: 時間単位で課金。
- **処理されたトラフィック**: ファイアウォールを通過したトラフィック量に応じて課金。
- **ルール評価**: 設定されたルール数やルール評価の回数に応じて課金。

### 6. よくあるアーキテクチャ・設計パターン

AWS Network Firewall は、様々なネットワークセキュリティのユースケースに対応できる。  
一般的なパターンは以下の通りです:

- **VPC 境界の保護**: VPC とインターネット間のトラフィックを検査し、不正なアクセスや攻撃をブロック。
- **インターネットからの悪意のあるトラフィックのブロック**: 既知の攻撃パターンや悪意のある IP アドレスからのトラフィックをブロック。
- **VPC 間のトラフィック制御**: 複数の VPC 間でやり取りされるトラフィックを制御し、ネットワークセグメンテーションを実現。
- **コンプライアンス要件の遵守**: セキュリティポリシーを適用し、業界のコンプライアンス要件を満たす。
- **カスタム脅威インテリジェンスの利用**: カスタムルールを作成し、特定の脅威に対抗。
- **ハイブリッドクラウド環境の保護**: オンプレミス環境と AWS 環境間のトラフィックを保護。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから AWS Network Firewall を開き、ファイアウォールポリシーを作成。
2. ファイアウォールルールグループを作成し、ルールを設定。
3. VPC 内に Network Firewall エンドポイントを作成。
4. VPC ルートテーブルを更新し、トラフィックを Network Firewall エンドポイントへルーティング。
5. Network Firewall のログを CloudWatch Logs で監視。

### 8. 試験で問われやすいポイント

#### 8.1 ステートフルファイアウォール

- **機能**: コネクションの状態を追跡し、双方向の通信を許可または拒否。
- **利用**: ネットワークトラフィックを詳細に制御。
- **試験対策**: ステートフルインスペクションの仕組み、メリットが問われる。

#### 8.2 柔軟なルール設定

- **エンジン**: Suricata 互換のルールエンジン。
- **設定**: IP アドレス、ポート、プロトコルなどの条件に基づいたカスタムルール。
- **試験対策**: カスタムルールの作成方法、ルールエンジンの特徴が問われる。

#### 8.3 侵入防止システム (IPS)

- **機能**: 悪意のあるネットワークトラフィックを検出し、自動的にブロック。
- **利用**: 既知の攻撃パターンや脆弱性への対策。
- **試験対策**: IPS の仕組み、検出対象が問われる。

#### 8.4 可視性

- **ログ送信先**: CloudWatch Logs。
- **目的**: ネットワークトラフィックの監視、セキュリティインシデントの分析。
- **試験対策**: ログの収集、分析方法が問われる。

#### 8.5 料金体系

- **課金対象**: ファイアウォールエンドポイントの利用時間、処理されたトラフィック量、ルール評価。
- **最適化**: 不要なトラフィックの削減、適切なルール設定がコスト削減に有効。
- **試験対策**: 料金体系、課金対象が問われる。

#### 8.6 類似・関連サービスとの比較

- **AWS Security Groups**: EC2 インスタンスのセキュリティ設定。Network Firewall は VPC レベルでのファイアウォールを提供。
- **AWS WAF**: Web アプリケーションの保護に特化。Network Firewall はネットワークレベルのトラフィック制御。

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: AWS Network Firewall は何を提供するサービスですか？
  - A: AWS 環境でネットワークトラフィックを保護するための、フルマネージドでスケーラブルなネットワークファイアウォールサービスである。
- Q: AWS Network Firewall は、どのようなトラフィックを制御できるか？
  - A: VPC 内のトラフィックを詳細に制御し、不正なアクセスや悪意のあるトラフィックをブロックできる。
- Q: AWS Network Firewall のルールは、どのように設定できるか？
  - A: Suricata 互換のルールエンジンを使用して、カスタムルールを定義できる。
- Q: AWS Network Firewall のログは、どこに送信されるか？
  - A: CloudWatch Logs に送信される。
- Q: AWS Network Firewall の料金はどのように計算されるか？
  - A: ファイアウォールエンドポイントの利用時間、処理されたトラフィック量、ルール評価などに基づいて計算される。

---

## AWS Resource Access Manager (AWS RAM)

### 1. サービス概要

AWS Resource Access Manager (AWS RAM)は、複数の AWS アカウント間でリソースを安全に共有するためのサービスである。  
AWS Organizations を用いたマルチアカウント構成や、外部アカウントとの共有においても、RAM を使うことで信頼できる方法でリソースをシームレスに共有できる。

主なユースケースとして、

- VPC サブネットや Transit Gateway の共有
- License Manager で管理するソフトウェアライセンスの共同利用
- ロードバランサや Route 53 のホストゾーン
- さまざまなサービスのリソースを組織全体で効率的に利用するケース

などが挙げられます。

### 2. 主な特徴と機能

#### 2.1 中央集約的なリソース共有

RAM を利用すると、メインとなるアカウントが VPC やサブネットといったリソースを「リソース共有」として定義し、他のアカウントがそれを使えるようにする仕組みを提供する。

- **一元管理**: リソース共有を一括で設定し、組織全体に波及
- **重複コストの削減**: リソースを使い回すことで、同等機能を再作成する必要性を低減

#### 2.2 AWS Organizations とのシームレス連携

AWS Organizations を用いたマルチアカウント構成では、組織単位(OU)や特定のメンバーアカウントを選択し、その範囲で RAM の共有設定を容易に行える。  
これにより、大規模環境でもスケーラブルかつセキュアにリソースを分配できる。

#### 2.3 多種多様なリソースタイプをサポート

AWS RAM は以下を含む複数のリソースを共有可能である:

- **VPC サブネット**: 他アカウントの EC2 インスタンスが同一 VPC 内で稼働するよう設定
- **AWS Transit Gateway**: マルチアカウントでのネットワークハブを効率的に共有
- **Route 53 Hosted Zone**: DNS ゾーンの共同管理
- **License Manager**: ソフトウェアライセンスの利用枠を組織横断で割り当て

#### 2.4 アクセスコントロールとポリシー

リソース共有はリソースシェアポリシーによって管理され、共有先のアカウントがどのようにリソースを使用できるかを定義する。  
AWS Organizations との連携で、組織全体に自動適用することも可能である。

#### 2.5 外部アカウント共有にも対応

同じ組織外の AWS アカウントともリソースを共有できるため、共同開発やパートナー企業との連携など、組織の垣根を越えた連携が必要な場合にも対応できる。

### 3. アーキテクチャおよび技術要素

1. リソース所有者アカウントが「Resource Share」を作成し、対象リソース（例: サブネット）を選択
2. 共有先として Organizations の OU、全メンバーアカウント、または特定アカウントを指定
3. 共有先アカウント側では、共有リソースを利用した VPC 設定やインスタンス起動などが可能
4. 不要になったらリソースシェアを削除、または共有範囲を変更することでアクセスを制御

RAM は IAM ポリシーや Organizations 設定と連携し、共有先を動的に管理できるため、大規模運用でも柔軟なアーキテクチャを構築できる。

### 4. セキュリティと認証・認可

リソース共有をセキュアに行うため、以下の観点が重要である:

- **IAM ポリシー**: RAM の「CreateResourceShare」「AssociateResourceShare」などの操作を許可するユーザーやロールを限定
- **Organizations 連携**: 承認されたメンバーアカウントだけがリソースを利用できるように制御
- **アクセススコープの明確化**: リソースシェアポリシーで使用可能範囲を明確に定義
- **監査ログ**: AWS CloudTrail を用いてリソース共有の操作履歴を常に記録

### 5. 料金形態

AWS Resource Access Manager 自体には利用料金はなく、無料で使用可能である。  
ただし、共有するリソースそのものの利用料金（VPC や EC2 など）は通常どおり発生する。  
例えば、共有先が EC2 インスタンスを立ち上げると、そのインスタンス料金は起動したアカウント側に課金される。

### 6. よくあるアーキテクチャ・設計パターン

RAM の代表的な活用パターンは以下の通りです:

- **集中管理されたネットワーク設計**: ネットワークを管理する専用アカウントで VPC やサブネットを作成し、他アカウントと共有
- **ライセンス一元管理**: License Manager でソフトウェアライセンスを組織横断で共有し、重複購入を回避
- **組織内・外部との共同開発**: 特定リソース(サブネットや Route 53 Hosted Zone)を外部アカウントにも安全に提供
- **一時的な開発環境共有**: 開発プロジェクトごとに必要なリソースだけを限定的に共有し、プロジェクト終了時に解除

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS コンソールで「AWS Resource Access Manager」を検索し、「Create resource share」をクリック
2. 共有したいリソースタイプ（例: VPC サブネット）を選び、対象となるリソースを追加
3. 「Add principals」画面で共有先として Organizations の OU やメンバーアカウント、外部アカウント ID を指定
4. 必要に応じて「Allow external accounts」オプションを有効化し、外部とのリソース共有を許可
5. 設定完了後、共有先アカウントで RAM の「Shared with me」タブを確認し、共有リソースを利用できるか確認

### 8. 試験で問われやすいポイント

#### 8.1 共有可能なリソースタイプ

- **VPC 関連**: サブネット、Transit Gateway
- **Route 53**: Hosted Zone の共有
- **AWS License Manager**: ソフトウェアライセンス
- **その他**: コードベースでアップデートされる場合があるので最新ドキュメントを参照

#### 8.2 Organizations との連携

- **条件**: RAM を管理するアカウントが Organizations 管理アカウントか、またはリソースシェアを許可されたメンバーアカウント
- **OU 単位共有**: OU を指定するだけで配下のすべてのアカウントに共有可能
- **メリット**: 大規模運用でも管理の手間を抑えられる

#### 8.3 アクセス許可ポリシーと IAM

- **IAM ポリシー**: 「ram:CreateResourceShare」「ram:AssociateResourceShare」など、操作権限を限定
- **リソースシェアポリシー**: 共有先アカウントがどのようにリソースを操作できるかの範囲を定義
- **最小権限の原則**: 余計なリソース共有を許可しないよう注意

#### 8.4 外部アカウント共有

- **アカウント ID 指定**: 組織外アカウントの場合、アカウント ID を明示的に指定
- **セキュリティ要件**: 共有先が正しいアカウント ID であることを厳密に確認
- **通信確認**: 組織外アカウントでリソースを利用できるかどうかテスト

#### 8.5 運用上の注意点

- **リソース変更**: 所有者アカウントでのリソース削除や設定変更は共有先にも影響
- **共有解除**: プロジェクト終了などで共有不要となったら迅速に解除
- **トラブルシューティング**: CloudTrail ログで操作履歴やエラーを確認

#### 8.6 試験で頻出となる具体的な問われ方と答え

Q: AWS Resource Access Manager (RAM)の主な目的は？
A: 複数アカウント間で VPC サブネットや Route 53 などのリソースを安全に共有する。
Q: リソースを共有する際に必要な設定要素は？
A: Resource Share の作成、共有するリソースの選択、共有先(アカウントや OU)の指定。
Q: マルチアカウントにおける利点は？
A: 重複リソースを作成せずに済み、コスト削減と運用効率の向上が期待できる。
Q: Organizations の OU と連携するメリットは？
A: OU 配下のすべてのアカウントに対して一括でリソースを共有・管理できる。
Q: RAM 自体の料金は？
A: 無料。ただし共有されるリソースの利用料金は通常どおり発生。

---

## AWS Secrets Manager

### 1. サービス概要

AWS Secrets Manager は、データベース認証情報、API キー、その他の機密情報を安全に保存、ローテーション、管理するためのサービスである。  
ユーザーは、アプリケーションコードに機密情報を埋め込むことなく、Secrets Manager からセキュアに機密情報を取得できる。  
Secrets Manager は、機密情報の管理を簡素化し、アプリケーションのセキュリティを向上させるための集中管理ソリューションを提供する。

主なユースケースとして、

- データベース認証情報の管理
- API キーの管理
- OAuth トークンの管理
- 証明書の管理
- アプリケーション設定の安全な保存

などが挙げられます。  
AWS Secrets Manager は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 機密情報の保存と管理

Secrets Manager は、データベースの認証情報、API キー、その他の機密情報を安全に保存し、管理できる。  
機密情報は、暗号化され、アクセス制御が適用される。

#### 2.2 自動ローテーション

データベースの認証情報や API キーなどの機密情報を自動的にローテーションできる。  
これにより、機密情報の漏洩リスクを低減し、セキュリティを強化できる。

#### 2.3 細粒度なアクセス制御

IAM ポリシーを使用して、機密情報へのアクセスを詳細に制御できる。  
特定のユーザーやグループに対して、機密情報の閲覧、ローテーション、削除などの権限を付与できる。

#### 2.4 バージョン管理

機密情報のバージョンを管理できる。  
これにより、過去のバージョンの機密情報を復元したり、変更履歴を確認したりできる。

#### 2.5 統合されたサービス

Secrets Manager は、RDS, EC2, Lambda, ECS, EKS など、AWS の他のサービスと統合されています。  
これにより、アプリケーションは Secrets Manager から機密情報を安全に取得できる。

#### 2.6 API アクセス

API を通じて、機密情報の取得、更新、削除などの操作を自動化できる。  
これにより、CI/CD パイプラインと連携して、機密情報を安全に管理できる。

#### 2.7 拡張性とスケーラビリティ

AWS Secrets Manager は、AWS のインフラ上で動作し、需要に応じて自動的にスケーリングする。  
これにより、大量の機密情報を管理する場合でも、安定したパフォーマンスを維持できる。

#### 3. アーキテクチャおよび技術要素

1. ユーザーは、Secrets Manager に機密情報を保存。
2. アプリケーションは、Secrets Manager API を通じて機密情報をリクエスト。
3. Secrets Manager は、IAM 認証に基づいてアクセスを許可し、機密情報を暗号化された状態で提供。
4. 必要に応じて、機密情報を自動的にローテーション。

AWS Secrets Manager は、AWS のインフラ上に構築されており、高い可用性と信頼性を提供する。  
機密情報の保存や管理は AWS が行うため、ユーザーはインフラの管理を行う必要はありません。

### 4. セキュリティと認証・認可

AWS Secrets Manager は、機密情報のセキュリティを確保するために、以下の機能を提供する:

- **IAM 統合**: AWS Identity and Access Management (IAM) を利用して、Secrets Manager へのアクセスを制御する。
- **データ暗号化**: 機密情報は転送中および保存時に暗号化される。
- **VPC エンドポイント**: VPC 内から Secrets Manager にアクセスする際に、インターネットを経由せずにアクセスできる。
- **アクセス制御**: IAM ポリシーを通じて、ユーザーやグループごとに、機密情報の操作権限を詳細に制御できる。
- **監査ログ**: CloudTrail を通じて、Secrets Manager の利用状況を監査できる。

これらのセキュリティ対策により、機密情報への不正アクセスを防止し、機密データを安全に保護できる。

### 5. 料金形態

AWS Secrets Manager の料金は主に以下に基づきます:

- **シークレット**: Secrets Manager に保存されたシークレット数に応じて課金。
- **API リクエスト**: Secrets Manager API へのリクエスト数に応じて課金。
- **ローテーション**: 自動ローテーション機能を利用した場合、ローテーション回数に応じて課金。

### 6. よくあるアーキテクチャ・設計パターン

AWS Secrets Manager は、様々なアプリケーションで利用できる。  
一般的なパターンは以下の通りです:

- **データベース認証情報の管理**: アプリケーションがデータベースに接続するための認証情報を Secrets Manager に保存し、ローテーションを自動化。
- **API キーの管理**: API を利用するための API キーを Secrets Manager に保存し、安全に管理。
- **OAuth トークンの管理**: OAuth トークンを Secrets Manager に保存し、セキュアにアクセス。
- **証明書の管理**: SSL/TLS 証明書を Secrets Manager に保存し、定期的にローテーション。
- **アプリケーション設定の安全な保存**: アプリケーションの設定値を Secrets Manager に保存し、コードから分離。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから AWS Secrets Manager を開き、新しいシークレットを作成。
2. 機密情報をキーと値のペアで入力し、ローテーション設定を構成。
3. IAM ポリシーを設定し、シークレットへのアクセス権限を付与。
4. アプリケーションで、Secrets Manager SDK を使ってシークレットを取得。
5. シークレットのローテーションをテスト。

### 8. 試験で問われやすいポイント

#### 8.1 機密情報の保存と管理

- **対象**: データベースの認証情報、API キーなど。
- **機能**: 機密情報を安全に保存し、管理。
- **試験対策**: 機密情報の保護方法、利用ケースが問われる。

#### 8.2 自動ローテーション

- **機能**: データベースの認証情報などを自動的にローテーション。
- **目的**: 機密情報の漏洩リスクを低減、セキュリティ強化。
- **試験対策**: 自動ローテーションの仕組み、メリットが問われる。

#### 8.3 細粒度なアクセス制御

- **利用**: IAM ポリシー。
- **目的**: 特定のユーザーやグループに対して、機密情報の操作権限を付与。
- **試験対策**: IAM ポリシーの設定方法、アクセス制御の範囲が問われる。

#### 8.4 バージョン管理

- **機能**: 機密情報のバージョンを管理。
- **利用**: 過去のバージョンの復元、変更履歴の確認。
- **試験対策**: バージョン管理の仕組み、利用ケースが問われる。

#### 8.5 料金体系

- **課金対象**: 保存されたシークレット数、API リクエスト数、ローテーション回数。
- **最適化**: 不要なシークレットの削除、API リクエスト数の削減がコスト削減に有効。
- **試験対策**: 料金体系、課金対象が問われる。

#### 8.6 類似・関連サービスとの比較

- **AWS Systems Manager Parameter Store**: 設定データや機密情報を管理するサービス。Secrets Manager は機密情報のローテーション機能を持つ。
- **AWS KMS**: 暗号化キーの管理に特化したサービス。Secrets Manager は機密情報の管理に特化。

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: AWS Secrets Manager は何を提供するサービスですか？
  - A: データベース認証情報、API キー、その他の機密情報を安全に保存、ローテーション、管理するためのサービスである。
- Q: AWS Secrets Manager では、どのような機密情報を管理できるか？
  - A: データベースの認証情報、API キー、OAuth トークン、証明書などを管理できる。
- Q: AWS Secrets Manager で、機密情報をローテーションするメリットは何ですか？
  - A: 機密情報の漏洩リスクを低減し、セキュリティを強化できる。
- Q: AWS Secrets Manager へのアクセスは、どのように制御するか？
  - A: IAM ポリシーを使用して、機密情報へのアクセスを詳細に制御できる。
- Q: AWS Secrets Manager の料金はどのように計算されるか？
  - A: Secrets Manager に保存されたシークレット数、API リクエスト数、自動ローテーション機能の利用回数に基づいて計算される。

---

## AWS Security Hub

### 1. サービス概要

AWS Security Hub は、複数の AWS セキュリティサービスやパートナー製品の検出結果（Findings）を一元的に集約・管理するサービスである。  
GuardDuty、Amazon Macie、AWS Firewall Manager、AWS Identity and Access Management (IAM) Access Analyzer、Inspector などの検出結果を統合し、脅威・脆弱性の可視化やコンプライアンス準拠度のモニタリングを容易にする。

主なユースケースとして、

- クラウド全体のセキュリティステータスの包括的な把握
- 検出結果を基にしたインシデント対応の迅速化
- レポーティングの効率化

などが挙げられます。  
AWS Organizations との連携により、複数アカウント環境でのセキュリティ運用を集中管理することも可能である。

### 2. 主な特徴と機能

#### 2.1 複数ソースからの Findings 統合

Security Hub は、AWS のセキュリティサービス（GuardDuty、Macie、Inspector、IAM Access Analyzer など）やサードパーティパートナー製品からの脅威検出結果（Findings）を一括して可視化する。  
各サービスごとに個別対応する手間を削減し、単一ダッシュボードで全体状況を把握できる。

- **GuardDuty**: ネットワークトラフィックやログを監視し、不審なアクティビティを検知
- **Amazon Macie**: S3 内の機密データ検知やアクセス状況の監査結果を取得
- **Inspector**: EC2 インスタンスやコンテナの脆弱性スキャン結果を統合

#### 2.2 コンプライアンスチェックと Best Practice の評価

Security Hub は、AWS Foundational Security Best Practices や各種規格（CIS AWS Foundations Benchmark など）に基づいたベストプラクティスチェックを実行し、準拠度スコアや推奨事項を提示する。  
定期的にチェックし、設定の誤りやセキュリティリスクを早期に把握できる。

#### 2.3 統合ダッシュボードでの優先度付け

異なるサービスから集約された Findings には Severity が付与されており、重要度に基づいた優先度付けが可能である。  
重大な問題（高 Severity）を先に対応し、全体のセキュリティリスクを低減する運用が容易になります。

#### 2.4 カスタムアクションと自動化

Security Hub は Amazon EventBridge と連携し、Findings をトリガーとして Lambda などのアクションを自動実行できる。  
例えば、脆弱性が見つかったら対象の EC2 インスタンスを隔離する、自動チケットを発行する、SNS で通知するといったワークフローを構築可能である。

#### 2.5 マルチアカウント管理

AWS Organizations を活用して、複数 AWS アカウントの Security Hub を一元管理できる。  
管理アカウント（Administrator Account）が全アカウントの Findings を集約し、集中監視やレポート生成を行える。  
大規模環境での運用を効率化し、セキュリティ体制を強化する。

### 3. アーキテクチャおよび技術要素

1. Security Hub を有効化し、集約したいサービス（GuardDuty、Macie、Inspector など）やパートナー製品との連携を設定
2. それぞれのサービスから Findings（検出結果）が Security Hub に送られる
3. Security Hub が Findings を統合的にリスト表示し、Severity や種類などでフィルタ
4. コンプライアンスチェックやベストプラクティス評価を定期的に実施
5. EventBridge ルールで自動化フローを構築（SNS 通知、Lambda 起動など）

これにより、複数のセキュリティツールを横断する形で Findings を一元管理し、即時対応と継続的改善が実現できる。

### 4. セキュリティと認証・認可

Security Hub は、他の AWS サービス同様に IAM を活用して認証・認可を行います:

- **IAM ポリシー**: Security Hub を閲覧・操作できる権限をユーザーやロール単位で設定
- **Cross-Account Access**: マルチアカウントで管理アカウントとメンバーアカウントを紐づける
- **CloudTrail 監査**: Security Hub API 呼び出しも CloudTrail に記録され、追跡可能

各セキュリティサービス自体が Findings を Security Hub に送信するために必要なポリシーやロールも適切に設定する必要がある。

### 5. 料金形態

AWS Security Hub の料金は、主に以下の要素に基づきます:

- **Findings の集約数**: 送信される Findings のボリュームに応じた従量課金
- **コンプライアンスチェック**: Security Hub が実施するベストプラクティス評価の対象リソース数
- **統合サービスの利用料金**: GuardDuty や Macie などの利用料は別途必要

### 6. よくあるアーキテクチャ・設計パターン

Security Hub の代表的な利用パターンは以下の通りです:

- **統合セキュリティ監視**: GuardDuty の脅威検知、Macie の機密データ検出、Inspector の脆弱性診断をまとめて確認
- **インシデント自動対応**: Security Hub の Findings 発生をトリガーに、EventBridge で Lambda を呼び出し、隔離・通報・タグ付け等を自動化
- **コンプライアンス評価**: CIS Benchmarks などのベストプラクティスチェックを定期的に実行し、問題箇所を早期発見
- **マルチアカウントの集中管理**: AWS Organizations との連携で、組織全体のセキュリティ状況を単一の管理者アカウントから把握

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS コンソールで「AWS Security Hub」を検索し、有効化(Enable Security Hub)
2. 「Settings」→「Integrations」で GuardDuty、Macie、Inspector など連携したいサービスを有効化
3. 「Security Standards」で CIS や Foundational Security Best Practices を有効化し、対象リソースを選択
4. Findings が集約されるダッシュボードを確認し、Severity やサービス別にソート/フィルタして問題点を把握
5. Amazon EventBridge ルールを作成し、高 Severity の Finding 検出時に SNS 通知や Lambda 実行などのアクションを定義

### 8. 試験で問われやすいポイント

#### 8.1 サービス統合

- **GuardDuty/Macie/Inspector**: 主な AWS セキュリティサービスの Findings を集約
- **パートナー製品**: Splunk や Palo Alto Networks などとも連携可能
- **ワークフロー自動化**: EventBridge で Lambda やチケットシステムに連携

#### 8.2 コンプライアンス評価

- **AWS Foundational Security Best Practices**: AWS 推奨の基本ベストプラクティス
- **CIS Benchmarks**: CIS AWS Foundations Benchmark の評価を自動で実施
- **スコアリング**: 不合格のチェック項目を確認し、修正を試みる流れがよく問われる

#### 8.3 マルチアカウント運用

- **Administrator/Member アカウント**: セキュリティ監視を中央集約する構成
- **Organizations 統合**: 複数アカウントが自動的に Security Hub に参加
- **メリット**: 大規模環境でも一括レポート、Findings 一覧、コンプライアンス状況を管理

#### 8.4 コスト管理

- **Findings 課金**: 大量の検出結果が発生する場合、GuardDuty や Macie などと合わせてコストを最適化
- **評価対象範囲**: 不要なスタンダードを無効化し、必要最小限のチェックに絞ることも検討

#### 8.5 自動修復（Remediation）の設計

- **EventBridge 連携**: Findings を検知 →Lambda 呼び出し → セキュリティルール適用などを自動化
- **SNS 通知**: 管理者にメールやチャット通知で迅速なインシデント対応
- **パートナー統合**: SOAR プラットフォームなどに Findings を渡し、自動的にワークフロー実行

#### 8.6 試験で頻出となる具体的な問われ方と答え

- Q: Security Hub で一元管理できるセキュリティ情報は？
  - A: GuardDuty や Macie、Inspector などの Findings およびコンプライアンスチェック結果。
- Q: Security Hub が提供するコンプライアンス評価は？
  - A: AWS Foundational Security Best Practices、CIS AWS Foundations Benchmark などの自動チェック。
- Q: High Severity の Finding に対し自動でアクションを起こすには？
  - A: EventBridge ルールで特定 Severity の Finding をトリガーに Lambda/SNS などを連携。
- Q: マルチアカウント環境での集中管理を可能にする仕組みは？
  - A: AWS Organizations 連携による管理アカウント(Member/Administrator 構成)。
- Q: Security Hub 自体の料金モデルは？
  - A: Findings 数とコンプライアンスチェック数に基づき従量課金(詳細は公式ページ参照)。

---

## AWS Shield

### 1. サービス概要

AWS Shield は、AWS で実行される Web アプリケーションやサービスを、DDoS（分散型サービス妨害）攻撃から保護するマネージドサービスである。  
ユーザーは、インフラストラクチャの変更や追加のハードウェアの導入なしに、自動的に DDoS 攻撃から保護される。  
AWS Shield は、アプリケーションの可用性とパフォーマンスを維持し、ビジネス継続性を確保するのに役立ちます。

主なユースケースとして、

- Web サイトの保護
- Web アプリケーションの保護
- API の保護
- DNS サービスの保護
- ネットワークレイヤーでの DDoS 攻撃防御

などが挙げられます。  
AWS Shield は、これらのユースケースに対応するための様々な機能と、AWS の他のサービスとの統合を提供する。

### 2. 主な特徴と機能

#### 2.1 Always-On Detection and Mitigation

AWS Shield は、DDoS 攻撃を常時監視し、自動的に緩和措置を適用する。  
これにより、攻撃の兆候を早期に検出し、アプリケーションへの影響を最小限に抑えることができる。

#### 2.2 ネットワークレイヤー保護

Shield は、ネットワークレイヤー（レイヤー 3 および 4）での DDoS 攻撃を防御する。  
これにより、TCP SYN フラッド、UDP フラッドなどの攻撃からインフラを保護できる。

#### 2.3 アプリケーションレイヤー保護

Shield Advanced は、アプリケーションレイヤー（レイヤー 7）での DDoS 攻撃を防御する。  
これにより、HTTP フラッド、SQL インジェクションなどの攻撃からアプリケーションを保護できる。

#### 2.4 攻撃の可視性

Shield は、攻撃に関する詳細な情報を提供する。  
ユーザーは、攻撃の種類、規模、発生時間などを確認し、セキュリティインシデントの分析に利用できる。

#### 2.5 統合されたサービス

Shield は、CloudFront, Elastic Load Balancing (ELB), Route 53 などの AWS の他のサービスと統合されており、これらのサービスを DDoS 攻撃から保護する。

#### 2.6 カスタマイズ可能な保護

Shield Advanced では、カスタムルールを作成し、特定のアプリケーションのニーズに合わせた保護を構成できる。  
これにより、特定の攻撃パターンに対する防御を強化できる。

#### 2.7 DDoS Response Team

Shield Advanced のユーザーは、DDoS 攻撃が発生した場合に、AWS の DDoS 対応チームからサポートを受けることができる。  
これにより、大規模な DDoS 攻撃に迅速に対応し、アプリケーションの可用性を維持できる。

### 3. アーキテクチャおよび技術要素

1. ユーザーは、AWS リソース（CloudFront, ELB, Route 53 など）を AWS Shield で保護。
2. Shield は、常にネットワークトラフィックを監視し、DDoS 攻撃を検出。
3. DDoS 攻撃が検出された場合、Shield は自動的に緩和策を適用し、攻撃を軽減。
4. 攻撃に関する情報は、CloudWatch メトリクスやログとして提供。
5. Shield Advanced のユーザーは、DDoS Response Team のサポートを受けることができる。

AWS Shield は、AWS のグローバルインフラストラクチャの一部であり、高い可用性とスケーラビリティを提供する。  
DDoS 攻撃の検出と緩和は AWS が行うため、ユーザーはインフラの管理を意識する必要はありません。

### 4. セキュリティと認証・認可

AWS Shield は、DDoS 攻撃から AWS リソースを保護するためのセキュリティ機能を提供する:

- **ネットワークレイヤー保護**: TCP SYN フラッド、UDP フラッドなどのネットワークレイヤーの攻撃を防御。
- **アプリケーションレイヤー保護**: HTTP フラッド、SQL インジェクションなどのアプリケーションレイヤーの攻撃を防御 (Shield Advanced)。
- **トラフィック分析**: ネットワークトラフィックを継続的に分析し、DDoS 攻撃を検出し、緩和。
- **アクセス制御**: IAM ポリシーを使用して、AWS Shield へのアクセスを制御。
- **データ保護**: Shield のログデータや設定データは暗号化される。

これらのセキュリティ対策により、AWS リソースを DDoS 攻撃から保護し、可用性と信頼性を確保する。

### 5. 料金形態

AWS Shield には、Standard と Advanced という 2 つのレベルがあり、料金体系が異なります。

- **AWS Shield Standard**: AWS Shield Standard は、追加料金なしで利用できる。
- **AWS Shield Advanced**: 月額料金と、保護対象のリソースの使用量に応じた料金が発生する。
- **データ転送**: Shield Advanced で保護されたリソースに対するデータ転送量に応じて課金。

### 6. よくあるアーキテクチャ・設計パターン

AWS Shield は、様々なアプリケーションの DDoS 攻撃防御に利用できる。  
一般的なパターンは以下の通りです:

- **Web サイトの保護**: Web サイトを CloudFront や ELB で保護し、DDoS 攻撃から可用性を確保。
- **Web アプリケーションの保護**: Web アプリケーションを ELB や API Gateway で保護し、アプリケーションレイヤーでの DDoS 攻撃を防御。
- **API の保護**: API Gateway で公開されている API を保護し、DDoS 攻撃によるサービス停止を防止。
- **DNS サービスの保護**: Route 53 で提供される DNS サービスを保護し、DNS 攻撃から可用性を確保。
- **ネットワークレイヤーでの DDoS 攻撃防御**: VPC 内のリソースを Network Firewall と組み合わせて保護し、ネットワークレイヤーでの攻撃を防御。

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS マネジメントコンソールから AWS Shield を開き、Shield Standard または Shield Advanced を有効化。
2. 保護対象となるリソース（CloudFront、ELB、Route 53 など）を選択。
3. Shield Advanced の場合は、必要に応じて、カスタムルールを設定。
4. CloudWatch メトリクスやログで、攻撃状況と緩和状況を監視。

### 8. 試験で問われやすいポイント

#### 8.1 Always-On Detection and Mitigation

- **機能**: DDoS 攻撃を常時監視し、自動的に緩和措置を適用。
- **目的**: 攻撃の兆候を早期に検出し、アプリケーションへの影響を最小限に抑制。
- **試験対策**: 常時監視の仕組み、メリットが問われる。

#### 8.2 ネットワークレイヤー保護

- **対象**: レイヤー 3 および 4 での DDoS 攻撃。
- **例**: TCP SYN フラッド、UDP フラッド。
- **試験対策**: 保護対象のレイヤー、攻撃の種類が問われる。

#### 8.3 アプリケーションレイヤー保護

- **対象**: レイヤー 7 での DDoS 攻撃。
- **例**: HTTP フラッド、SQL インジェクションなど。
- **試験対策**: 保護対象のレイヤー、攻撃の種類が問われる。

#### 8.4 攻撃の可視性

- **情報**: 攻撃の種類、規模、発生時間など。
- **利用**: セキュリティインシデントの分析。
- **試験対策**: 提供される情報の種類、分析への活用が問われる。

#### 8.5 料金体系

- **Shield Standard**: 追加料金なし。
- **Shield Advanced**: 月額料金、リソース使用量、データ転送量。
- **試験対策**: 各プランの料金体系、課金対象が問われる。

#### 8.6 類似・関連サービスとの比較

- **AWS WAF**: Web アプリケーションのレイヤー 7 の攻撃を防御するサービス。Shield は DDoS 攻撃に特化。
- **AWS Firewall Manager**: 組織全体でのセキュリティポリシーを一元管理するサービス。Shield は DDoS 防御に特化。

#### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: AWS Shield は何を提供するサービスですか？
  - A: AWS で実行される Web アプリケーションやサービスを、DDoS（分散型サービス妨害）攻撃から保護するマネージドサービスである。
- Q: AWS Shield Standard と AWS Shield Advanced の違いは何ですか？
  - A: Shield Standard は基本的な DDoS 攻撃保護を提供し、Shield Advanced はアプリケーションレイヤーでの保護、DDoS Response Team のサポートなど、より高度な機能を提供する。
- Q: AWS Shield は、どのような種類の DDoS 攻撃から保護できるか？
  - A: ネットワークレイヤー（レイヤー 3 および 4）およびアプリケーションレイヤー（レイヤー 7）での DDoS 攻撃から保護できる。
- Q: AWS Shield は、どのような AWS サービスと統合されていますか？
  - A: CloudFront, Elastic Load Balancing (ELB), Route 53 などのサービスと統合されています。
- Q: AWS Shield の料金体系は？
  - A: AWS Shield Standard は無料、AWS Shield Advanced は月額料金とリソース使用量に応じた料金が発生する。

---

## AWS WAF

### 1. サービス概要

AWS WAF（Web Application Firewall）は、Web アプリケーション層への攻撃を防御するためのサービスで、SQL インジェクションやクロスサイトスクリプティング（XSS）など、よくある脆弱性パターンから保護する。  
CloudFront や Application Load Balancer(ALB)、Amazon API Gateway、AppSync などとの統合ができ、ルールを柔軟に定義してアクセスを制御可能である。

主なユースケースとして、

- 不正リクエストのブロックや Bot 対策
- カスタムヘッダの検知
- IP レピュテーションリストの参照

などが挙げられます。  
AWS WAF を活用することで、Web アプリケーションレイヤーの攻撃を低コストかつスケーラブルに防御することが可能である。

### 2. 主な特徴と機能

#### 2.1 ルールベースのフィルタリング

WAF は以下のような種類のルールで不正アクセスをフィルタリングする:

- **IP マッチ条件**: 指定したソース IP アドレスや IP レンジからのリクエストを許可/ブロック
- **String マッチ/正規表現マッチ**: HTTP ヘッダや URI パスに特定文字列や正規表現が含まれる場合にアクションを実行
- **Size constraint**: リクエストサイズが閾値を超えた場合に制御
- **SQL インジェクション/XSS 検知**: 代表的な攻撃パターンを自動検知してブロック

#### 2.2 マネージドルールとカスタムルール

AWS WAF では、事前定義されたマネージドルール（AWS やサードパーティが提供）を導入することで、OWASP Top 10 をはじめとする一般的な攻撃への対策を簡単に設定可能である。  
また、カスタムルールを使って独自のビジネスロジックを反映した防御を行うこともできる。

#### 2.3 Bot Control/レートベースルール

最近の AWS WAF には Bot Control 機能が追加され、クローラーやスクレイピングなどのボットトラフィックを制御できる。  
また、レートベースルールを利用すると、一定時間内に大量アクセスしている IP を自動的にブロックすることが可能である。

#### 2.4 可視化とアナリティクス

WAF では、CloudWatch メトリクスやログ（WAF ログ）と連携することで、トラフィックの可視化や分析が可能である。  
不正なリクエストの種類や発生元 IP を把握し、継続的なルール最適化を行うことができる。

#### 2.5 CloudFront/ALB/API Gateway との統合

WAF は主に以下のサービスと統合できる:

- **Amazon CloudFront**: CDN で配信するコンテンツを WAF で保護
- **Application Load Balancer**: ALB 経由でアクセスされる Web アプリケーションを保護
- **Amazon API Gateway/AppSync**: API エンドポイントや GraphQL エンドポイントへの不正アクセスをフィルタ

このように、様々なエントリーポイントをカバーしており、複数サービス間で一貫したルール設定が可能である。

### 3. アーキテクチャおよび技術要素

1. WAF ポリシー（WebACL）を作成し、使用するルールを定義
2. ポリシーを CloudFront ディストリビューションや ALB 等のリソースに関連付け
3. WAF は受信リクエストをルールの順番に従って評価し、マッチしたアクション（Allow/Block/Count/Captcha）を実行
4. ルール実行結果は CloudWatch メトリクスや WAF ログとして蓄積され、可視化・分析が可能

これにより、アプリケーション層に到達する前に攻撃トラフィックをブロックし、セキュリティ強度を高めるアーキテクチャを構築できる。

### 4. セキュリティと認証・認可

AWS WAF 自体はマネージドサービスであり、AWS IAM を活用して WAF ポリシーを操作できるユーザーやロールを制御する:

- **IAM ポリシー**: 「waf:\*」などの API コールを許可/拒否する形で操作権限を管理
- **運用監査**: AWS CloudTrail を通じて WAF のルール変更やポリシー適用などの操作履歴を追跡可能
- **Shield Advanced 連携**: DDoS 対策サービスとの併用で攻撃を多層防御

### 5. 料金形態

AWS WAF の料金は以下の要素で構成される:

- **Web ACL 数**: 作成した Web ACL（WAF ポリシー）ごとに月額料金が発生
- **ルール数**: Web ACL に紐づくルール数に応じた月額料金
- **リクエスト数**: WAF が評価するリクエスト数に基づく従量課金

### 6. よくあるアーキテクチャ・設計パターン

典型的な AWS WAF の導入パターンは以下の通りです:

- **CDN 保護**: CloudFront と連携し、グローバル配信される Web コンテンツへ不正アクセスをブロック
- **ALB フロントエンド**: ALB に WAF を設定し、アプリケーションサーバへの攻撃を未然に防止
- **API 保護**: API Gateway や AppSync と統合し、API 呼び出しを制御・分析
- **マネージドルール活用**: AWS やサードパーティが提供するスニペットを利用して構成を簡易化

### 7. 設定・デプロイ手順（ハンズオン例）

1. AWS コンソールで「AWS WAF」を検索し、「Web ACL」を作成
2. 「Add rules and rule groups」をクリックし、AWS Managed Rules を選択、またはカスタムルールを追加
3. 「Default web ACL action」を Allow または Block に設定
4. 適用先のリソース（CloudFront ディストリビューションや ALB など）を選択
5. 設定完了後、WAF のダッシュボードや CloudWatch ログでリクエストがブロック/許可されているかを確認

### 8. 試験で問われやすいポイント

#### 8.1 ルールタイプと動作

- **IP match, String match, Regex match**: HTTP リクエスト要素を精査
- **SQL/XSS detection**: 代表的なアプリケーション攻撃を自動検知
- **Rate-based rule**: 同一 IP からの過剰アクセスをブロック

#### 8.2 マネージドルール vs. カスタムルール

- **マネージドルール**: AWS や各ベンダーが提供、容易に導入できるが柔軟性は限定的
- **カスタムルール**: 特定の攻撃パターンやユースケースに合わせた詳細設定
- **使い分け**: 基本防御はマネージドルール＋ビジネスロジックに合わせたカスタムルール

#### 8.3 CloudFront/ALB/API Gateway 連携

- **Edge ロケーション保護**: CloudFront と組み合わせてグローバルに攻撃を阻止
- **ALB 経由**: オンプレミスや EC2 上の Web アプリを保護
- **API 保護**: API Gateway で REST/HTTP リクエストを統合管理

#### 8.4 運用と可視化

- **Logging**: S3 や CloudWatch Logs に WAF ログを保存し、分析ツールと連携
- **Monitoring**: CloudWatch メトリクスでルールマッチ数や HTTP ステータスを可視化
- **チューニング**: 過剰ブロック(誤検知)を防ぎつつ攻撃を適切に防ぐためのルールの継続的調整

#### 8.5 料金構造

- **Web ACL 月額**: WebACL ごとに固定費用
- **ルール追加コスト**: ルール 1 つごとに月額料金
- **リクエスト数従量課金**: 評価対象となるリクエスト数が増えるとコスト増

#### 8.6 試験で頻出となる具体的な問われ方と答え

- Q: AWS WAF でよくある防御対象は？
  - A: SQL インジェクション、XSS、Bot アクセス、レート制限など。
- Q: マネージドルールとカスタムルールの違いは？
  - A: マネージドルールは既存テンプレートを使った簡易導入、カスタムルールは独自の条件で細かい調整。
- Q: AWS WAF を適用できるサービスは？
  - A: CloudFront、ALB、API Gateway、AppSync。
- Q: Rate-based rule の用途は？
  - A: 同一 IP からの短時間で大量アクセスを検知/ブロックする際に利用。
- Q: AWS WAF ログを分析するには？
  - A: CloudWatch Logs や S3 にログを保存し、Athena や Elasticsearch などで可視化・分析。
