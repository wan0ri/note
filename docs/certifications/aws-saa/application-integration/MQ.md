---
title: Amazon MQ
---

## 1. サービス概要

Amazon MQ は、AWS が提供するフルマネージドのメッセージブローカーサービス。  
このサービスを利用することで、Apache ActiveMQ と RabbitMQ という 2 つの一般的なメッセージブローカーを、クラウド上で簡単にデプロイ、運用できる。  
Amazon MQ は、メッセージングシステムに必要なインフラストラクチャの管理を AWS に任せ、アプリケーションの疎結合と信頼性の高いメッセージングをサポートする。

主なユースケースとして、

- マイクロサービスアーキテクチャにおける非同期通信
- 分散システムにおけるメッセージング
- トランザクション処理
- イベントドリブンアーキテクチャ

などが挙げられる。

## 2. 主な特徴と機能

### 2.1 Apache ActiveMQ と RabbitMQ のサポート

Amazon MQ は、Apache ActiveMQ と RabbitMQ という 2 つの一般的なメッセージブローカーをサポートしている。  
これにより、既存のアプリケーションで使用されているメッセージングフレームワークをそのまま利用できる。

- **Apache ActiveMQ**: Java ベースのメッセージブローカーで、幅広いプロトコル (JMS, AMQP, MQTT, STOMP など) をサポート。
- **RabbitMQ**: Erlang で開発されたメッセージブローカーで、AMQP プロトコルをサポート。

### 2.2 フルマネージドサービス

メッセージブローカーのプロビジョニング、スケーリング、パッチ適用、バックアップなどの運用管理は AWS が自動で行う。  
これにより、ユーザーはインフラ管理に煩わされることなく、アプリケーションの開発に集中できる。

### 2.3 可用性と耐久性

Amazon MQ は、複数のアベイラビリティーゾーンにデータを分散して保存し、自動的にフェイルオーバーを処理する。  
これにより、高い可用性と耐久性を実現し、システムのダウンタイムを最小限に抑える。

### 2.4 セキュリティ

Amazon MQ は、データの暗号化、アクセス制御、ネットワーク分離などのセキュリティ機能を提供する。  
IAM によるアクセス制御、転送中のデータ暗号化、保存中のデータ暗号化、VPC 内でのプライベート接続をサポートしている。

- **IAM 連携**: AWS IAM を使用してアクセス制御と権限管理。
- **データ暗号化**: 転送中および保存中のデータを暗号化。
- **VPC サポート**: Amazon VPC 内でのプライベート接続。

### 2.5 メッセージの耐久性

メッセージは、永続ストレージに保存され、ブローカーの障害時にも失われないように保護されている。  
これにより、信頼性の高いメッセージングを実現できる。

### 2.6 メトリクスとモニタリング

Amazon CloudWatch と統合されており、メッセージブローカーのパフォーマンス、メッセージ数、接続数などを監視できる。  
これにより、システムの状態を常に把握し、異常を早期に発見できる。

### 2.7 統合性

Amazon MQ は、AWS の他のサービス（AWS Lambda, Amazon ECS, Amazon SQS など）と統合されており、様々なアプリケーションアーキテクチャに対応できる。  
AWS X-Ray と連携して分散トレーシングを行うことができる。

## 3. アーキテクチャおよび技術要素

1. アプリケーションは、メッセージブローカーにメッセージを送信。
2. Amazon MQ は、メッセージをキューまたはトピックに保存。
3. アプリケーションは、メッセージブローカーからメッセージを受信。
4. メッセージは、複数のアベイラビリティーゾーンに分散して保存。
5. 自動フェイルオーバー機能により、高可用性を確保。

Amazon MQ は、フルマネージドサービスとして提供され、高い可用性、スケーラビリティ、セキュリティを内包している。  
メッセージングに必要なインフラ管理を簡素化し、開発者はアプリケーション開発に集中できる。

## 4. セキュリティと認証・認可

セキュリティは Amazon MQ の重要な要素:

- **IAM によるアクセス制御**: AWS IAM を利用して、Amazon MQ リソースへのアクセスを制御し、権限を管理。
- **データ暗号化**: 転送中および保存中のデータを暗号化し、データの機密性を保護。
- **VPC サポート**: Amazon VPC 内で Amazon MQ を使用する場合、プライベート接続を確立。
- **認証**: メッセージブローカーのユーザー名とパスワードによる認証を提供。
- **監査ログ**: AWS CloudTrail を利用して、API 呼び出しやリソース変更を記録。

## 5. 料金形態

Amazon MQ の料金は主に以下に基づく:

- **ブローカーインスタンス料金**: メッセージブローカーの実行時間に応じた課金。
- **ストレージ料金**: メッセージブローカーが使用するストレージ量に応じた課金。
- **データ転送料金**: データ転送量に応じた課金。

## 6. よくあるアーキテクチャ・設計パターン

一般的なパターンは以下の通り:

- **マイクロサービスアーキテクチャ**: マイクロサービス間の非同期通信にメッセージブローカーを利用し、疎結合を促進。
- **分散システム**: 分散システムでメッセージングを利用して、異なるコンポーネント間で情報を伝達。
- **トランザクション処理**: トランザクション処理をメッセージキューに格納し、処理の信頼性と効率性を向上。
- **イベントドリブンアーキテクチャ**: イベントが発生した際にメッセージブローカーを介して通知し、関連するサービスを起動。
- **アプリケーション統合**: 異なるアプリケーション間でメッセージブローカーを利用してデータの統合。

## 7. 設定・デプロイ手順（ハンズオン例）

1. AWS コンソールで Amazon MQ のブローカーを作成（ActiveMQ または RabbitMQ を選択）。
2. ブローカーのアクセス設定を行い、クライアントアプリケーションが接続できるように設定。
3. メッセージをキューまたはトピックに送信。
4. メッセージブローカーからメッセージを受信。
5. CloudWatch でメトリクスを監視。

## 8. 試験で問われやすいポイント

### 8.1 Apache ActiveMQ と RabbitMQ のサポート

- **ActiveMQ**: Java ベース、様々なプロトコルをサポートすることを理解。
- **RabbitMQ**: AMQP プロトコルをサポートすることを理解。
- **フレームワーク選択**: 既存のアプリケーションの要件に合わせて適切なブローカーを選択することを理解。

### 8.2 フルマネージドサービス

- **運用管理**: メッセージブローカーのプロビジョニング、スケーリング、パッチ適用、バックアップなどを AWS が自動で管理することを理解。
- **開発への集中**: ユーザーはインフラ管理に煩わされることなく、アプリケーション開発に集中できることを理解。

### 8.3 可用性と耐久性

- **マルチ AZ**: 複数のアベイラビリティーゾーンにデータを分散して保存することを理解。
- **自動フェイルオーバー**: 自動フェイルオーバー機能で高い可用性を実現することを理解。

### 8.4 セキュリティ

- **IAM**: IAM によるアクセス制御と権限管理について理解。
- **データ暗号化**: 転送中および保存中のデータを暗号化することを理解。
- **VPC サポート**: VPC 内でのプライベート接続について理解。
- **認証**: メッセージブローカーの認証機能について理解。

### 8.5 料金体系

- **ブローカーインスタンス**: メッセージブローカーの実行時間による課金を理解。
- **ストレージ**: メッセージブローカーが使用するストレージ量による課金を理解。
- **データ転送**: データ転送量による課金を理解。

### 8.6 類似・関連サービスとの比較

- **Amazon SQS**: キューイングサービス。Amazon MQ はメッセージブローカー。
- **Amazon SNS**: パブリッシュ/サブスクライブ型メッセージングサービス。Amazon MQ はより柔軟なメッセージルーティングが可能。

### 8.7 試験で頻出となる具体的な問われ方と答え

- Q: Amazon MQ の主な用途は？
  - A: メッセージブローカーのデプロイ、運用管理を簡素化し、アプリケーションの疎結合を促進すること。
- Q: Amazon MQ がサポートするメッセージブローカーは？
  - A: Apache ActiveMQ と RabbitMQ。
- Q: Amazon MQ のフルマネージドとは？
  - A: メッセージブローカーの運用管理を AWS が行うこと。
- Q: Amazon MQ でメッセージの耐久性を確保する方法は？
  - A: 永続ストレージにメッセージを保存すること。
- Q: Amazon MQ のセキュリティ対策は？
  - A: IAM によるアクセス制御、データ暗号化、VPC サポートなど。
- Q: Amazon MQ の料金体系は？
  - A: ブローカーインスタンス、ストレージ、データ転送に応じた課金。
- Q: Amazon MQ と Amazon SQS の違いは？
  - A: SQS はキューイングサービス、Amazon MQ はメッセージブローカー。
